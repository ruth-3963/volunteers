{"ast":null,"code":"import { addClass, createElement, closest, remove, removeClass } from '@syncfusion/ej2-base';\nimport { VerticalEvent } from '../event-renderer/vertical-view';\nimport { MonthEvent } from '../event-renderer/month';\nimport { TimelineEvent } from '../event-renderer/timeline-view';\nimport * as cls from '../base/css-constant';\nimport * as events from '../base/constant';\nimport * as util from '../base/util';\n/**\r\n * Inline Edit interactions\r\n */\n\nvar InlineEdit =\n/** @class */\nfunction () {\n  /**\r\n   * Constructor for InlineEdit\r\n   */\n  function InlineEdit(parent) {\n    this.parent = parent;\n    this.parent.on(events.inlineClick, this.inlineEdit, this);\n  }\n\n  InlineEdit.prototype.inlineEdit = function (args) {\n    this.parent.quickPopup.quickPopupHide();\n\n    if (args.type === 'Cell') {\n      this.removeInlineAppointmentElement();\n      this.cellEdit(args);\n    } else {\n      if (this.parent.element.querySelector('.' + cls.INLINE_SUBJECT_CLASS) !== args.element.querySelector('.' + cls.INLINE_SUBJECT_CLASS)) {\n        this.removeInlineAppointmentElement();\n      }\n\n      this.eventEdit(args);\n    }\n  };\n\n  InlineEdit.prototype.cellEdit = function (args) {\n    var saveObj = this.generateEventData();\n    var cellIndex = args.element.cellIndex;\n    var count = this.getEventDaysCount(saveObj);\n\n    if (count > 1) {\n      count = Math.round(count);\n      count--;\n      cellIndex = cellIndex - count;\n    }\n\n    var start = util.resetTime(new Date('' + saveObj[this.parent.eventFields.startTime])).getTime();\n    var end = util.resetTime(new Date('' + saveObj[this.parent.eventFields.endTime])).getTime();\n    var resIndex = args.groupIndex || 0;\n\n    if (this.parent.currentView === 'Day' || this.parent.currentView === 'Week' || this.parent.currentView === 'WorkWeek') {\n      var dayIndex = saveObj[this.parent.eventFields.startTime].getDay();\n      this.createVerticalViewInline(saveObj, dayIndex, resIndex, cellIndex);\n    } else if (this.parent.currentView === 'Month') {\n      this.createMonthViewInline(saveObj, resIndex, start, end);\n    } else {\n      this.createTimelineViewInline(saveObj, start, end, resIndex);\n    }\n\n    var inlineSubject = this.parent.element.querySelector('.' + cls.INLINE_SUBJECT_CLASS);\n\n    if (inlineSubject) {\n      inlineSubject.focus();\n    }\n  };\n\n  InlineEdit.prototype.eventEdit = function (args) {\n    var inlineSubject = args.element.querySelector('.' + cls.INLINE_SUBJECT_CLASS);\n    var subject;\n\n    if (inlineSubject) {\n      subject = inlineSubject.value;\n    } else {\n      var subEle = args.element.querySelector('.' + cls.SUBJECT_CLASS);\n      var timeEle = args.element.querySelector('.' + cls.APPOINTMENT_TIME);\n      subject = subEle.innerText;\n      inlineSubject = createElement('input', {\n        className: cls.INLINE_SUBJECT_CLASS,\n        attrs: {\n          value: subject\n        }\n      });\n      addClass([subEle], cls.DISABLE_CLASS);\n\n      if (closest(args.element, '.' + cls.MORE_POPUP_WRAPPER_CLASS)) {\n        args.element.insertBefore(inlineSubject, subEle);\n      } else if (['Agenda', 'MonthAgenda'].indexOf(this.parent.currentView) > -1) {\n        var subjectWrap = args.element.querySelector('.' + cls.SUBJECT_WRAP);\n        subjectWrap.insertBefore(inlineSubject, subjectWrap.firstChild);\n      } else {\n        var elementSelector = ['TimelineWeek', 'TimelineMonth'].indexOf(this.parent.currentView) > -1 ? '.e-inner-wrap' : '.e-appointment-details';\n        args.element.querySelector(elementSelector).insertBefore(inlineSubject, timeEle);\n      }\n    }\n\n    inlineSubject.focus();\n    inlineSubject.setSelectionRange(subject.length, subject.length);\n  };\n\n  InlineEdit.prototype.createVerticalViewInline = function (saveObj, dayIndex, resIndex, daysCount) {\n    var count = this.getEventDaysCount(saveObj);\n    var verticalEvent = new VerticalEvent(this.parent);\n    verticalEvent.initializeValues();\n    var index = verticalEvent.dateRender[resIndex].map(function (date) {\n      return date.getDay();\n    }).indexOf(dayIndex);\n\n    if (count >= 1) {\n      verticalEvent.allDayElement = [].slice.call(this.parent.element.querySelectorAll('.' + cls.ALLDAY_CELLS_CLASS));\n      verticalEvent.slots.push(this.parent.activeView.renderDates.map(function (date) {\n        return +date;\n      }));\n      var allDayElements = [].slice.call(this.parent.element.querySelectorAll('.' + cls.ALLDAY_APPOINTMENT_CLASS));\n      var allDayLevel = 0;\n\n      if (allDayElements.length > 0) {\n        allDayLevel = Math.floor(this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).getBoundingClientRect().height / allDayElements[0].offsetHeight) - 1;\n      }\n\n      verticalEvent.allDayLevel = allDayLevel;\n      verticalEvent.renderAllDayEvents(saveObj, index, resIndex, daysCount, this.parent.allowInline);\n    } else {\n      verticalEvent.renderNormalEvents(saveObj, index, resIndex, daysCount, this.parent.allowInline);\n    }\n  };\n\n  InlineEdit.prototype.createMonthViewInline = function (saveObj, index, start, end) {\n    var count = this.getEventDaysCount(saveObj);\n    var saveObject = this.parent.eventBase.cloneEventObject(saveObj, start, end, count, false, false);\n    var monthEvent = new MonthEvent(this.parent);\n    monthEvent.dateRender = this.parent.activeView.renderDates;\n    monthEvent.inlineValue = this.parent.allowInline;\n    var renderDates = this.parent.activeView.renderDates;\n    var workDays = this.parent.activeViewOptions.workDays;\n    var monthCellSelector = '.' + cls.WORK_CELLS_CLASS;\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      monthCellSelector += '[data-group-index=\"' + index + '\"]';\n      var resourceData = this.parent.resourceBase.lastResourceLevel[index];\n      renderDates = resourceData.renderDates;\n      workDays = resourceData.workDays;\n    }\n\n    monthEvent.workCells = [].slice.call(this.parent.element.querySelectorAll(monthCellSelector));\n    monthEvent.cellWidth = monthEvent.workCells[0].offsetWidth;\n    monthEvent.cellHeight = monthEvent.workCells[0].offsetHeight;\n    monthEvent.eventHeight = util.getElementHeightFromClass(this.parent.monthModule.element, cls.APPOINTMENT_CLASS);\n    monthEvent.getSlotDates(workDays);\n    var filteredDates = monthEvent.getRenderedDates(renderDates);\n    var splittedEvents = monthEvent.splitEvent(saveObject, filteredDates || renderDates);\n\n    for (var _i = 0, splittedEvents_1 = splittedEvents; _i < splittedEvents_1.length; _i++) {\n      var eventData = splittedEvents_1[_i];\n      monthEvent.renderEvents(eventData, index);\n    }\n\n    var inlineSubject = this.parent.element.querySelector('.' + cls.INLINE_SUBJECT_CLASS);\n    inlineSubject.focus();\n  };\n\n  InlineEdit.prototype.createTimelineViewInline = function (saveObj, start, end, resIndex) {\n    var count = this.getEventDaysCount(saveObj);\n    var saveObject = this.parent.eventBase.cloneEventObject(saveObj, start, end, count, false, false);\n    var timelineView = new TimelineEvent(this.parent, this.parent.activeViewOptions.timeScale.enable ? 'hour' : 'day');\n    timelineView.dateRender = this.parent.activeView.renderDates;\n    timelineView.eventContainers = [].slice.call(this.parent.element.querySelectorAll('.' + cls.APPOINTMENT_CONTAINER_CLASS));\n    var workCell = this.parent.element.querySelector('.' + cls.WORK_CELLS_CLASS);\n    timelineView.inlineValue = this.parent.allowInline;\n    timelineView.cellWidth = workCell.offsetWidth;\n    timelineView.cellHeight = workCell.offsetHeight;\n    var dayLength = this.parent.element.querySelectorAll('.' + cls.CONTENT_TABLE_CLASS + ' tbody tr').length === 0 ? 0 : this.parent.element.querySelectorAll('.' + cls.CONTENT_TABLE_CLASS + ' tbody tr')[0].children.length;\n    timelineView.slotsPerDay = dayLength / timelineView.dateRender.length;\n    timelineView.eventHeight = util.getElementHeightFromClass(timelineView.element, cls.APPOINTMENT_CLASS);\n    timelineView.renderEvents(saveObject, resIndex);\n  };\n\n  InlineEdit.prototype.getEventDaysCount = function (saveObj) {\n    var startDate = saveObj[this.parent.eventFields.startTime];\n    var endDate = saveObj[this.parent.eventFields.endTime];\n    var daysCount = Math.abs(endDate.getTime() - startDate.getTime()) / util.MS_PER_DAY;\n    return daysCount;\n  };\n\n  InlineEdit.prototype.generateEventData = function (target) {\n    var inlineElement = this.parent.element.querySelector('.' + cls.INLINE_SUBJECT_CLASS);\n    var subject = inlineElement ? inlineElement.value : target ? target.innerHTML : '';\n    var saveObj = {};\n    saveObj[this.parent.eventFields.id] = this.parent.eventBase.getEventMaxID();\n    saveObj[this.parent.eventFields.subject] = subject;\n    saveObj[this.parent.eventFields.startTime] = this.parent.activeCellsData.startTime;\n    saveObj[this.parent.eventFields.endTime] = this.parent.activeCellsData.endTime;\n    saveObj[this.parent.eventFields.isAllDay] = this.parent.activeCellsData.isAllDay;\n    this.parent.eventWindow.setDefaultValueToObject(saveObj);\n\n    if (this.parent.resourceBase) {\n      this.parent.resourceBase.setResourceValues(saveObj, this.parent.activeCellsData.groupIndex);\n    }\n\n    return saveObj;\n  };\n\n  InlineEdit.prototype.documentClick = function () {\n    var target = this.parent.element.querySelector('.' + cls.INLINE_SUBJECT_CLASS);\n\n    if (target && target.value !== '') {\n      this.inlineCrudActions(target);\n    }\n  };\n\n  InlineEdit.prototype.inlineCrudActions = function (target) {\n    if (closest(target, '.' + cls.INLINE_APPOINTMENT_CLASS)) {\n      var saveObj = this.generateEventData(target);\n      this.parent.addEvent(saveObj);\n    } else {\n      var eventTarget = closest(target, '.' + cls.APPOINTMENT_CLASS);\n      var eventDetails = this.parent.getEventDetails(eventTarget);\n      eventDetails[this.parent.eventFields.subject] = target.value;\n      var currentAction = void 0;\n\n      if (eventDetails[this.parent.eventFields.id] === eventDetails[this.parent.eventFields.recurrenceID]) {\n        currentAction = 'EditOccurrence';\n        eventDetails[this.parent.eventFields.id] = this.parent.eventBase.getEventMaxID();\n      }\n\n      this.parent.saveEvent(eventDetails, currentAction);\n    }\n\n    this.removeInlineAppointmentElement();\n  };\n\n  InlineEdit.prototype.createInlineAppointmentElement = function (inlineData) {\n    var inlineAppointmentElement = createElement('div', {\n      className: cls.APPOINTMENT_CLASS + ' ' + cls.INLINE_APPOINTMENT_CLASS\n    });\n    var inlineDetails = createElement('div', {\n      className: cls.APPOINTMENT_DETAILS\n    });\n    inlineAppointmentElement.appendChild(inlineDetails);\n    var inline = createElement('input', {\n      className: cls.INLINE_SUBJECT_CLASS\n    });\n    inlineDetails.appendChild(inline);\n\n    if (inlineData) {\n      this.parent.eventBase.applyResourceColor(inlineAppointmentElement, inlineData, 'backgroundColor');\n    }\n\n    return inlineAppointmentElement;\n  };\n\n  InlineEdit.prototype.removeInlineAppointmentElement = function () {\n    var inlineAppointment = [].slice.call(this.parent.element.querySelectorAll('.' + cls.INLINE_APPOINTMENT_CLASS));\n\n    if (inlineAppointment.length > 0) {\n      inlineAppointment.forEach(function (node) {\n        return remove(node);\n      });\n    }\n\n    var inlineSubject = this.parent.element.querySelector('.' + cls.INLINE_SUBJECT_CLASS);\n\n    if (inlineSubject) {\n      var appointmentSubject = closest(inlineSubject, '.' + cls.APPOINTMENT_CLASS);\n      removeClass([appointmentSubject.querySelector('.' + cls.SUBJECT_CLASS)], cls.DISABLE_CLASS);\n      remove(inlineSubject);\n    }\n  };\n\n  InlineEdit.prototype.destroy = function () {\n    this.parent.off(events.inlineClick, this.inlineEdit);\n  };\n\n  return InlineEdit;\n}();\n\nexport { InlineEdit };","map":{"version":3,"sources":["C:/Users/User/volunteers/node_modules/@syncfusion/ej2-schedule/src/schedule/event-renderer/inline-edit.js"],"names":["addClass","createElement","closest","remove","removeClass","VerticalEvent","MonthEvent","TimelineEvent","cls","events","util","InlineEdit","parent","on","inlineClick","inlineEdit","prototype","args","quickPopup","quickPopupHide","type","removeInlineAppointmentElement","cellEdit","element","querySelector","INLINE_SUBJECT_CLASS","eventEdit","saveObj","generateEventData","cellIndex","count","getEventDaysCount","Math","round","start","resetTime","Date","eventFields","startTime","getTime","end","endTime","resIndex","groupIndex","currentView","dayIndex","getDay","createVerticalViewInline","createMonthViewInline","createTimelineViewInline","inlineSubject","focus","subject","value","subEle","SUBJECT_CLASS","timeEle","APPOINTMENT_TIME","innerText","className","attrs","DISABLE_CLASS","MORE_POPUP_WRAPPER_CLASS","insertBefore","indexOf","subjectWrap","SUBJECT_WRAP","firstChild","elementSelector","setSelectionRange","length","daysCount","verticalEvent","initializeValues","index","dateRender","map","date","allDayElement","slice","call","querySelectorAll","ALLDAY_CELLS_CLASS","slots","push","activeView","renderDates","allDayElements","ALLDAY_APPOINTMENT_CLASS","allDayLevel","floor","ALLDAY_ROW_CLASS","getBoundingClientRect","height","offsetHeight","renderAllDayEvents","allowInline","renderNormalEvents","saveObject","eventBase","cloneEventObject","monthEvent","inlineValue","workDays","activeViewOptions","monthCellSelector","WORK_CELLS_CLASS","group","resources","resourceData","resourceBase","lastResourceLevel","workCells","cellWidth","offsetWidth","cellHeight","eventHeight","getElementHeightFromClass","monthModule","APPOINTMENT_CLASS","getSlotDates","filteredDates","getRenderedDates","splittedEvents","splitEvent","_i","splittedEvents_1","eventData","renderEvents","timelineView","timeScale","enable","eventContainers","APPOINTMENT_CONTAINER_CLASS","workCell","dayLength","CONTENT_TABLE_CLASS","children","slotsPerDay","startDate","endDate","abs","MS_PER_DAY","target","inlineElement","innerHTML","id","getEventMaxID","activeCellsData","isAllDay","eventWindow","setDefaultValueToObject","setResourceValues","documentClick","inlineCrudActions","INLINE_APPOINTMENT_CLASS","addEvent","eventTarget","eventDetails","getEventDetails","currentAction","recurrenceID","saveEvent","createInlineAppointmentElement","inlineData","inlineAppointmentElement","inlineDetails","APPOINTMENT_DETAILS","appendChild","inline","applyResourceColor","inlineAppointment","forEach","node","appointmentSubject","destroy","off"],"mappings":"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","sourcesContent":["import { addClass, createElement, closest, remove, removeClass } from '@syncfusion/ej2-base';\r\nimport { VerticalEvent } from '../event-renderer/vertical-view';\r\nimport { MonthEvent } from '../event-renderer/month';\r\nimport { TimelineEvent } from '../event-renderer/timeline-view';\r\nimport * as cls from '../base/css-constant';\r\nimport * as events from '../base/constant';\r\nimport * as util from '../base/util';\r\n/**\r\n * Inline Edit interactions\r\n */\r\nvar InlineEdit = /** @class */ (function () {\r\n    /**\r\n     * Constructor for InlineEdit\r\n     */\r\n    function InlineEdit(parent) {\r\n        this.parent = parent;\r\n        this.parent.on(events.inlineClick, this.inlineEdit, this);\r\n    }\r\n    InlineEdit.prototype.inlineEdit = function (args) {\r\n        this.parent.quickPopup.quickPopupHide();\r\n        if (args.type === 'Cell') {\r\n            this.removeInlineAppointmentElement();\r\n            this.cellEdit(args);\r\n        }\r\n        else {\r\n            if (this.parent.element.querySelector('.' + cls.INLINE_SUBJECT_CLASS) !==\r\n                args.element.querySelector('.' + cls.INLINE_SUBJECT_CLASS)) {\r\n                this.removeInlineAppointmentElement();\r\n            }\r\n            this.eventEdit(args);\r\n        }\r\n    };\r\n    InlineEdit.prototype.cellEdit = function (args) {\r\n        var saveObj = this.generateEventData();\r\n        var cellIndex = args.element.cellIndex;\r\n        var count = this.getEventDaysCount(saveObj);\r\n        if (count > 1) {\r\n            count = Math.round(count);\r\n            count--;\r\n            cellIndex = cellIndex - count;\r\n        }\r\n        var start = util.resetTime(new Date('' + saveObj[this.parent.eventFields.startTime])).getTime();\r\n        var end = util.resetTime(new Date('' + saveObj[this.parent.eventFields.endTime])).getTime();\r\n        var resIndex = args.groupIndex || 0;\r\n        if (this.parent.currentView === 'Day' || this.parent.currentView === 'Week' || this.parent.currentView === 'WorkWeek') {\r\n            var dayIndex = saveObj[this.parent.eventFields.startTime].getDay();\r\n            this.createVerticalViewInline(saveObj, dayIndex, resIndex, cellIndex);\r\n        }\r\n        else if (this.parent.currentView === 'Month') {\r\n            this.createMonthViewInline(saveObj, resIndex, start, end);\r\n        }\r\n        else {\r\n            this.createTimelineViewInline(saveObj, start, end, resIndex);\r\n        }\r\n        var inlineSubject = this.parent.element.querySelector('.' + cls.INLINE_SUBJECT_CLASS);\r\n        if (inlineSubject) {\r\n            inlineSubject.focus();\r\n        }\r\n    };\r\n    InlineEdit.prototype.eventEdit = function (args) {\r\n        var inlineSubject = args.element.querySelector('.' + cls.INLINE_SUBJECT_CLASS);\r\n        var subject;\r\n        if (inlineSubject) {\r\n            subject = inlineSubject.value;\r\n        }\r\n        else {\r\n            var subEle = args.element.querySelector('.' + cls.SUBJECT_CLASS);\r\n            var timeEle = args.element.querySelector('.' + cls.APPOINTMENT_TIME);\r\n            subject = subEle.innerText;\r\n            inlineSubject = createElement('input', { className: cls.INLINE_SUBJECT_CLASS, attrs: { value: subject } });\r\n            addClass([subEle], cls.DISABLE_CLASS);\r\n            if (closest(args.element, '.' + cls.MORE_POPUP_WRAPPER_CLASS)) {\r\n                args.element.insertBefore(inlineSubject, subEle);\r\n            }\r\n            else if (['Agenda', 'MonthAgenda'].indexOf(this.parent.currentView) > -1) {\r\n                var subjectWrap = args.element.querySelector('.' + cls.SUBJECT_WRAP);\r\n                subjectWrap.insertBefore(inlineSubject, subjectWrap.firstChild);\r\n            }\r\n            else {\r\n                var elementSelector = ['TimelineWeek', 'TimelineMonth'].indexOf(this.parent.currentView) > -1 ?\r\n                    '.e-inner-wrap' : '.e-appointment-details';\r\n                args.element.querySelector(elementSelector).insertBefore(inlineSubject, timeEle);\r\n            }\r\n        }\r\n        inlineSubject.focus();\r\n        inlineSubject.setSelectionRange(subject.length, subject.length);\r\n    };\r\n    InlineEdit.prototype.createVerticalViewInline = function (saveObj, dayIndex, resIndex, daysCount) {\r\n        var count = this.getEventDaysCount(saveObj);\r\n        var verticalEvent = new VerticalEvent(this.parent);\r\n        verticalEvent.initializeValues();\r\n        var index = verticalEvent.dateRender[resIndex].map(function (date) { return date.getDay(); }).indexOf(dayIndex);\r\n        if (count >= 1) {\r\n            verticalEvent.allDayElement = [].slice.call(this.parent.element.querySelectorAll('.' + cls.ALLDAY_CELLS_CLASS));\r\n            verticalEvent.slots.push(this.parent.activeView.renderDates.map(function (date) { return +date; }));\r\n            var allDayElements = [].slice.call(this.parent.element.querySelectorAll('.' + cls.ALLDAY_APPOINTMENT_CLASS));\r\n            var allDayLevel = 0;\r\n            if (allDayElements.length > 0) {\r\n                allDayLevel = Math.floor(this.parent.element.querySelector('.' + cls.ALLDAY_ROW_CLASS).getBoundingClientRect().height /\r\n                    allDayElements[0].offsetHeight) - 1;\r\n            }\r\n            verticalEvent.allDayLevel = allDayLevel;\r\n            verticalEvent.renderAllDayEvents(saveObj, index, resIndex, daysCount, this.parent.allowInline);\r\n        }\r\n        else {\r\n            verticalEvent.renderNormalEvents(saveObj, index, resIndex, daysCount, this.parent.allowInline);\r\n        }\r\n    };\r\n    InlineEdit.prototype.createMonthViewInline = function (saveObj, index, start, end) {\r\n        var count = this.getEventDaysCount(saveObj);\r\n        var saveObject = this.parent.eventBase.cloneEventObject(saveObj, start, end, count, false, false);\r\n        var monthEvent = new MonthEvent(this.parent);\r\n        monthEvent.dateRender = this.parent.activeView.renderDates;\r\n        monthEvent.inlineValue = this.parent.allowInline;\r\n        var renderDates = this.parent.activeView.renderDates;\r\n        var workDays = this.parent.activeViewOptions.workDays;\r\n        var monthCellSelector = '.' + cls.WORK_CELLS_CLASS;\r\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\r\n            monthCellSelector += '[data-group-index=\"' + index + '\"]';\r\n            var resourceData = this.parent.resourceBase.lastResourceLevel[index];\r\n            renderDates = resourceData.renderDates;\r\n            workDays = resourceData.workDays;\r\n        }\r\n        monthEvent.workCells = [].slice.call(this.parent.element.querySelectorAll(monthCellSelector));\r\n        monthEvent.cellWidth = monthEvent.workCells[0].offsetWidth;\r\n        monthEvent.cellHeight = monthEvent.workCells[0].offsetHeight;\r\n        monthEvent.eventHeight = util.getElementHeightFromClass(this.parent.monthModule.element, cls.APPOINTMENT_CLASS);\r\n        monthEvent.getSlotDates(workDays);\r\n        var filteredDates = monthEvent.getRenderedDates(renderDates);\r\n        var splittedEvents = monthEvent.splitEvent(saveObject, filteredDates || renderDates);\r\n        for (var _i = 0, splittedEvents_1 = splittedEvents; _i < splittedEvents_1.length; _i++) {\r\n            var eventData = splittedEvents_1[_i];\r\n            monthEvent.renderEvents(eventData, index);\r\n        }\r\n        var inlineSubject = this.parent.element.querySelector('.' + cls.INLINE_SUBJECT_CLASS);\r\n        inlineSubject.focus();\r\n    };\r\n    InlineEdit.prototype.createTimelineViewInline = function (saveObj, start, end, resIndex) {\r\n        var count = this.getEventDaysCount(saveObj);\r\n        var saveObject = this.parent.eventBase.cloneEventObject(saveObj, start, end, count, false, false);\r\n        var timelineView = new TimelineEvent(this.parent, this.parent.activeViewOptions.timeScale.enable ? 'hour' : 'day');\r\n        timelineView.dateRender = this.parent.activeView.renderDates;\r\n        timelineView.eventContainers = [].slice.call(this.parent.element.querySelectorAll('.' + cls.APPOINTMENT_CONTAINER_CLASS));\r\n        var workCell = this.parent.element.querySelector('.' + cls.WORK_CELLS_CLASS);\r\n        timelineView.inlineValue = this.parent.allowInline;\r\n        timelineView.cellWidth = workCell.offsetWidth;\r\n        timelineView.cellHeight = workCell.offsetHeight;\r\n        var dayLength = this.parent.element.querySelectorAll('.' + cls.CONTENT_TABLE_CLASS + ' tbody tr').length === 0 ?\r\n            0 : this.parent.element.querySelectorAll('.' + cls.CONTENT_TABLE_CLASS + ' tbody tr')[0].children.length;\r\n        timelineView.slotsPerDay = dayLength / timelineView.dateRender.length;\r\n        timelineView.eventHeight = util.getElementHeightFromClass(timelineView.element, cls.APPOINTMENT_CLASS);\r\n        timelineView.renderEvents(saveObject, resIndex);\r\n    };\r\n    InlineEdit.prototype.getEventDaysCount = function (saveObj) {\r\n        var startDate = saveObj[this.parent.eventFields.startTime];\r\n        var endDate = saveObj[this.parent.eventFields.endTime];\r\n        var daysCount = Math.abs(endDate.getTime() - startDate.getTime()) / util.MS_PER_DAY;\r\n        return daysCount;\r\n    };\r\n    InlineEdit.prototype.generateEventData = function (target) {\r\n        var inlineElement = this.parent.element.querySelector('.' + cls.INLINE_SUBJECT_CLASS);\r\n        var subject = inlineElement ? inlineElement.value : target ? target.innerHTML : '';\r\n        var saveObj = {};\r\n        saveObj[this.parent.eventFields.id] = this.parent.eventBase.getEventMaxID();\r\n        saveObj[this.parent.eventFields.subject] = subject;\r\n        saveObj[this.parent.eventFields.startTime] = this.parent.activeCellsData.startTime;\r\n        saveObj[this.parent.eventFields.endTime] = this.parent.activeCellsData.endTime;\r\n        saveObj[this.parent.eventFields.isAllDay] = this.parent.activeCellsData.isAllDay;\r\n        this.parent.eventWindow.setDefaultValueToObject(saveObj);\r\n        if (this.parent.resourceBase) {\r\n            this.parent.resourceBase.setResourceValues(saveObj, this.parent.activeCellsData.groupIndex);\r\n        }\r\n        return saveObj;\r\n    };\r\n    InlineEdit.prototype.documentClick = function () {\r\n        var target = this.parent.element.querySelector('.' + cls.INLINE_SUBJECT_CLASS);\r\n        if (target && target.value !== '') {\r\n            this.inlineCrudActions(target);\r\n        }\r\n    };\r\n    InlineEdit.prototype.inlineCrudActions = function (target) {\r\n        if (closest(target, '.' + cls.INLINE_APPOINTMENT_CLASS)) {\r\n            var saveObj = this.generateEventData(target);\r\n            this.parent.addEvent(saveObj);\r\n        }\r\n        else {\r\n            var eventTarget = closest(target, '.' + cls.APPOINTMENT_CLASS);\r\n            var eventDetails = this.parent.getEventDetails(eventTarget);\r\n            eventDetails[this.parent.eventFields.subject] = target.value;\r\n            var currentAction = void 0;\r\n            if (eventDetails[this.parent.eventFields.id] === eventDetails[this.parent.eventFields.recurrenceID]) {\r\n                currentAction = 'EditOccurrence';\r\n                eventDetails[this.parent.eventFields.id] = this.parent.eventBase.getEventMaxID();\r\n            }\r\n            this.parent.saveEvent(eventDetails, currentAction);\r\n        }\r\n        this.removeInlineAppointmentElement();\r\n    };\r\n    InlineEdit.prototype.createInlineAppointmentElement = function (inlineData) {\r\n        var inlineAppointmentElement = createElement('div', {\r\n            className: cls.APPOINTMENT_CLASS + ' ' + cls.INLINE_APPOINTMENT_CLASS\r\n        });\r\n        var inlineDetails = createElement('div', { className: cls.APPOINTMENT_DETAILS });\r\n        inlineAppointmentElement.appendChild(inlineDetails);\r\n        var inline = createElement('input', { className: cls.INLINE_SUBJECT_CLASS });\r\n        inlineDetails.appendChild(inline);\r\n        if (inlineData) {\r\n            this.parent.eventBase.applyResourceColor(inlineAppointmentElement, inlineData, 'backgroundColor');\r\n        }\r\n        return inlineAppointmentElement;\r\n    };\r\n    InlineEdit.prototype.removeInlineAppointmentElement = function () {\r\n        var inlineAppointment = [].slice.call(this.parent.element.querySelectorAll('.' + cls.INLINE_APPOINTMENT_CLASS));\r\n        if (inlineAppointment.length > 0) {\r\n            inlineAppointment.forEach(function (node) { return remove(node); });\r\n        }\r\n        var inlineSubject = this.parent.element.querySelector('.' + cls.INLINE_SUBJECT_CLASS);\r\n        if (inlineSubject) {\r\n            var appointmentSubject = closest(inlineSubject, '.' + cls.APPOINTMENT_CLASS);\r\n            removeClass([appointmentSubject.querySelector('.' + cls.SUBJECT_CLASS)], cls.DISABLE_CLASS);\r\n            remove(inlineSubject);\r\n        }\r\n    };\r\n    InlineEdit.prototype.destroy = function () {\r\n        this.parent.off(events.inlineClick, this.inlineEdit);\r\n    };\r\n    return InlineEdit;\r\n}());\r\nexport { InlineEdit };\r\n"]},"metadata":{},"sourceType":"module"}