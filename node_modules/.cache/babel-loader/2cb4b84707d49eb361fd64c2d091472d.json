{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nimport { EventHandler, formatUnit, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { createElement, remove, addClass, removeClass, append, prepend } from '@syncfusion/ej2-base';\nimport { ViewBase } from './view-base';\nimport { MonthEvent } from '../event-renderer/month';\nimport * as util from '../base/util';\nimport * as event from '../base/constant';\nimport * as cls from '../base/css-constant';\n/**\r\n * month view\r\n */\n\nvar Month =\n/** @class */\nfunction (_super) {\n  __extends(Month, _super);\n  /**\r\n   * Constructor for month view\r\n   */\n\n\n  function Month(parent) {\n    var _this = _super.call(this, parent) || this;\n\n    _this.dayNameFormat = 'wide';\n    _this.viewClass = 'e-month-view';\n    _this.isInverseTableSelect = false;\n    _this.monthDates = {};\n    return _this;\n  }\n\n  Month.prototype.addEventListener = function () {\n    this.parent.on(event.scrollUiUpdate, this.onScrollUIUpdate, this);\n    this.parent.on(event.dataReady, this.onDataReady, this);\n    this.parent.on(event.cellClick, this.onCellClick, this);\n  };\n\n  Month.prototype.removeEventListener = function () {\n    this.parent.off(event.scrollUiUpdate, this.onScrollUIUpdate);\n    this.parent.off(event.dataReady, this.onDataReady);\n    this.parent.off(event.cellClick, this.onCellClick);\n  };\n\n  Month.prototype.onDataReady = function (args) {\n    var monthEvent = new MonthEvent(this.parent);\n    monthEvent.renderAppointments();\n    this.parent.notify(event.eventsLoaded, {});\n  };\n\n  Month.prototype.onCellClick = function (event) {// Here cell click\n  };\n\n  Month.prototype.onContentScroll = function (e) {\n    this.parent.removeNewEventElement();\n    this.parent.notify(event.virtualScroll, e);\n    this.scrollTopPanel(e.target);\n    this.scrollLeftPanel(e.target);\n    this.setPersistence();\n  };\n\n  Month.prototype.scrollLeftPanel = function (target) {\n    var leftPanel = this.getLeftPanelElement();\n\n    if (leftPanel) {\n      leftPanel.scrollTop = target.scrollTop;\n    }\n  };\n\n  Month.prototype.getLeftPanelElement = function () {\n    return this.element.querySelector('.' + cls.WEEK_NUMBER_WRAPPER_CLASS);\n  };\n\n  Month.prototype.onScrollUIUpdate = function (args) {\n    var headerHeight = this.getHeaderBarHeight();\n    var header = this.getDatesHeaderElement();\n    var content = this.getContentAreaElement();\n    var height = this.parent.element.offsetHeight - headerHeight - header.offsetHeight;\n    var leftPanel = this.getLeftPanelElement();\n    this.setContentHeight(content, leftPanel, height);\n    var scrollBarWidth = util.getScrollBarWidth(); // tslint:disable:no-any\n\n    header.firstElementChild.style[args.cssProperties.rtlBorder] = '';\n    header.style[args.cssProperties.rtlPadding] = '';\n\n    if (content.offsetWidth - content.clientWidth > 0) {\n      header.firstElementChild.style[args.cssProperties.border] = scrollBarWidth > 0 ? '1px' : '0px';\n      header.style[args.cssProperties.padding] = scrollBarWidth > 0 ? scrollBarWidth - 1 + 'px' : '0px';\n    } else {\n      header.firstElementChild.style[args.cssProperties.border] = '';\n      header.style[args.cssProperties.padding] = '';\n    } // tslint:enable:no-any\n\n\n    this.setColWidth(content);\n\n    if (args.scrollPosition) {\n      if (leftPanel) {\n        leftPanel.scrollTop = args.scrollPosition.top;\n      }\n\n      content.scrollTop = args.scrollPosition.top;\n      content.scrollLeft = args.scrollPosition.left;\n    } else {\n      var headerCell = document.querySelector('.' + cls.HEADER_CELLS_CLASS + '[data-date=\"' + this.parent.getMsFromDate(this.parent.selectedDate) + '\"]');\n      content.scrollLeft = headerCell !== null ? headerCell.offsetLeft : 0;\n    }\n\n    this.retainScrollPosition();\n  };\n\n  Month.prototype.setContentHeight = function (content, leftPanelElement, height) {\n    content.style.height = 'auto';\n\n    if (this.parent.currentView === 'Month') {\n      content.style.height = formatUnit(height);\n    }\n\n    if (leftPanelElement) {\n      if (this.parent.currentView === 'MonthAgenda') {\n        height = this.element.querySelector('.' + cls.CONTENT_TABLE_CLASS).offsetHeight;\n      }\n\n      leftPanelElement.style.height = 'auto';\n      leftPanelElement.style.height = formatUnit(height - this.getScrollXIndent(content));\n    }\n  };\n\n  Month.prototype.generateColumnLevels = function () {\n    var colLevels = [];\n    var level = this.getDateSlots(this.renderDates, this.parent.activeViewOptions.workDays);\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      colLevels = this.parent.resourceBase.generateResourceLevels(level);\n\n      if (this.parent.currentView === 'MonthAgenda') {\n        colLevels = [level];\n      }\n\n      if (this.parent.uiStateValues.isGroupAdaptive && this.parent.resourceBase.lastResourceLevel.length > 0) {\n        var resourceLevel = this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex];\n        colLevels = [this.getDateSlots(resourceLevel.renderDates, resourceLevel.workDays)];\n      }\n    } else {\n      colLevels.push(level);\n    }\n\n    this.colLevels = colLevels;\n    return colLevels;\n  };\n\n  Month.prototype.getDateSlots = function (renderDates, workDays) {\n    var count = this.parent.activeViewOptions.showWeekend ? util.WEEK_LENGTH : workDays.length;\n    var dateSlots = [];\n\n    for (var col = 0; col < count; col++) {\n      var classList = [cls.HEADER_CELLS_CLASS];\n      var currentDateIndex = renderDates.slice(0, count).map(function (date) {\n        return date.getDay();\n      });\n\n      if (this.isCurrentMonth(this.parent.selectedDate) && currentDateIndex.indexOf(this.parent.getCurrentTime().getDay()) === col) {\n        classList.push(cls.CURRENT_DAY_CLASS);\n      }\n\n      dateSlots.push({\n        date: renderDates[col],\n        type: 'monthDay',\n        className: classList,\n        colSpan: 1,\n        workDays: workDays\n      });\n    }\n\n    return dateSlots;\n  };\n\n  Month.prototype.getDayNameFormat = function () {\n    if (this.parent.isAdaptive || this.parent.activeViewOptions.group.resources.length > 0) {\n      return 'abbreviated';\n    }\n\n    return 'wide';\n  };\n\n  Month.prototype.serverRenderLayout = function () {\n    var curElem = [].slice.call(this.parent.element.querySelectorAll('.' + cls.CURRENT_DAY_CLASS));\n\n    if (curElem.length > 0) {\n      removeClass(curElem, cls.CURRENT_DAY_CLASS);\n    }\n\n    var curDate = util.addLocalOffset(new Date(new Date().setHours(0, 0, 0, 0)));\n    var queryString = '.' + cls.WORK_CELLS_CLASS + '[data-date=\"' + curDate.getTime().toString() + '\"]';\n\n    if (this.parent.currentView === 'Month' || this.parent.currentView === 'MonthAgenda') {\n      curElem = [].slice.call(this.parent.element.querySelectorAll('.' + cls.CURRENTDATE_CLASS));\n\n      if (curElem.length > 0) {\n        removeClass(curElem, cls.CURRENTDATE_CLASS);\n      }\n\n      var curEle = [].slice.call(this.parent.element.querySelectorAll(queryString));\n\n      for (var _i = 0, curEle_1 = curEle; _i < curEle_1.length; _i++) {\n        var ele = curEle_1[_i];\n        var index = ele.cellIndex;\n        var curHeader = [].slice.call(this.parent.element.querySelectorAll('.' + cls.HEADER_CELLS_CLASS))[index];\n        addClass([ele], cls.CURRENTDATE_CLASS);\n        addClass([curHeader], cls.CURRENT_DAY_CLASS);\n      }\n    }\n\n    if (this.parent.currentView === 'TimelineMonth') {\n      var curEle = this.parent.element.querySelector('.' + cls.HEADER_CELLS_CLASS + '[data-date=\"' + curDate.getTime().toString() + '\"]');\n\n      if (!isNullOrUndefined(curEle)) {\n        addClass([curEle], cls.CURRENT_DAY_CLASS);\n      }\n    }\n\n    this.setPanel(this.parent.element.querySelector('.' + cls.TABLE_WRAP_CLASS));\n    var target = this.parent.currentView === 'MonthAgenda' ? this.parent.activeView.getPanel() : this.parent.element;\n    var headerCells = [].slice.call(this.element.querySelectorAll('.' + cls.DATE_HEADER_WRAP_CLASS + ' td.' + cls.HEADER_CELLS_CLASS));\n\n    for (var _a = 0, headerCells_1 = headerCells; _a < headerCells_1.length; _a++) {\n      var cell = headerCells_1[_a];\n      EventHandler.clearEvents(cell);\n      this.wireCellEvents(cell);\n    }\n\n    var contentBody = this.element.querySelector('.' + cls.CONTENT_TABLE_CLASS + ' tbody');\n    EventHandler.clearEvents(contentBody);\n    this.wireCellEvents(contentBody);\n\n    if (this.parent.virtualScrollModule) {\n      this.parent.virtualScrollModule.setTranslateValue();\n    }\n\n    var wrap = this.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\n    EventHandler.clearEvents(wrap);\n    EventHandler.add(wrap, 'scroll', this.onContentScroll, this);\n    this.wireExpandCollapseIconEvents();\n    this.renderAppointmentContainer();\n\n    if (this.parent.uiStateValues.isGroupAdaptive && !target.querySelector('.' + cls.RESOURCE_TOOLBAR_CONTAINER)) {\n      this.renderResourceMobileLayout();\n    }\n\n    this.parent.notify(event.contentReady, {});\n  };\n\n  Month.prototype.renderLayout = function (type) {\n    this.dayNameFormat = this.getDayNameFormat();\n\n    if (this.parent.isServerRenderer()) {\n      this.colLevels = this.generateColumnLevels();\n\n      if (this.parent.activeView.isTimelineView() && this.parent.resourceBase && this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n        this.parent.resourceBase.setRenderedResources();\n      }\n\n      return;\n    }\n\n    this.setPanel(createElement('div', {\n      className: cls.TABLE_WRAP_CLASS\n    }));\n    var clsList = [this.viewClass];\n    clsList.push(type);\n\n    if (this.parent.activeViewOptions.group.byDate) {\n      clsList.push('e-by-date');\n    }\n\n    if (this.parent.activeViewOptions.allowVirtualScrolling) {\n      clsList.push(cls.VIRTUAL_SCROLL_CLASS);\n    }\n\n    if (this.parent.eventSettings.ignoreWhitespace) {\n      clsList.push(cls.IGNORE_WHITESPACE);\n    }\n\n    addClass([this.element], clsList);\n    this.renderPanel(type);\n    this.element.appendChild(this.createTableLayout(cls.OUTER_TABLE_CLASS));\n    this.element.querySelector('table').setAttribute('role', 'presentation');\n    this.colLevels = this.generateColumnLevels();\n    this.renderHeader();\n    this.renderContent();\n    var target = this.parent.currentView === 'MonthAgenda' ? this.parent.activeView.getPanel() : this.parent.element;\n\n    if (this.parent.uiStateValues.isGroupAdaptive && !target.querySelector('.' + cls.RESOURCE_TOOLBAR_CONTAINER)) {\n      this.renderResourceMobileLayout();\n    }\n\n    this.parent.notify(event.contentReady, {});\n  };\n\n  Month.prototype.wireCellEvents = function (element) {\n    EventHandler.add(element, 'mousedown', this.parent.workCellAction.cellMouseDown, this.parent.workCellAction);\n    EventHandler.add(element, 'click', this.parent.workCellAction.cellClick, this.parent.workCellAction);\n\n    if (!this.parent.isAdaptive) {\n      EventHandler.add(element, 'dblclick', this.parent.workCellAction.cellDblClick, this.parent.workCellAction);\n    }\n  };\n\n  Month.prototype.renderHeader = function () {\n    var tr = createElement('tr');\n    this.renderLeftIndent(tr);\n    var dateTd = createElement('td');\n    dateTd.appendChild(this.renderDatesHeader());\n    tr.appendChild(dateTd);\n    prepend([tr], this.element.querySelector('tbody'));\n  };\n\n  Month.prototype.renderLeftIndent = function (tr) {\n    if (this.parent.activeViewOptions.showWeekNumber) {\n      tr.appendChild(createElement('td', {\n        className: 'e-left-indent'\n      }));\n    }\n  };\n\n  Month.prototype.renderContent = function () {\n    var tr = createElement('tr');\n\n    if (this.parent.activeViewOptions.showWeekNumber) {\n      tr.appendChild(this.renderWeekNumberContent());\n    }\n\n    var workTd = createElement('td');\n    var wrap = createElement('div', {\n      className: cls.CONTENT_WRAP_CLASS\n    });\n    var contentArea = this.renderContentArea();\n\n    if (this.parent.currentView === 'Month') {\n      wrap.appendChild(contentArea);\n    } else {\n      var monthAgendaWrapper = createElement('div', {\n        className: cls.TABLE_CONTAINER_CLASS\n      });\n      monthAgendaWrapper.appendChild(contentArea);\n      wrap.appendChild(monthAgendaWrapper);\n    }\n\n    EventHandler.add(wrap, 'scroll', this.onContentScroll, this);\n    workTd.appendChild(wrap);\n    tr.appendChild(workTd);\n    this.element.querySelector('tbody').appendChild(tr);\n    this.renderAppointmentContainer();\n  };\n\n  Month.prototype.renderWeekNumberContent = function () {\n    var dateCol = this.renderDates.map(function (date) {\n      return new Date(+date);\n    });\n    var td = createElement('td');\n    var contentWrapper = createElement('div', {\n      className: cls.WEEK_NUMBER_WRAPPER_CLASS\n    });\n    td.appendChild(contentWrapper);\n    var contentWrapTable = this.createTableLayout();\n    contentWrapper.appendChild(contentWrapTable);\n    var noOfDays = this.parent.activeViewOptions.showWeekend ? util.WEEK_LENGTH : this.parent.activeViewOptions.workDays.length;\n\n    for (var i = 0, length_1 = this.renderDates.length / noOfDays; i < length_1; i++) {\n      var dates = dateCol.splice(0, noOfDays);\n      var weekNumber = this.getWeekNumberContent(dates).toString();\n      contentWrapTable.querySelector('tbody').appendChild(this.createWeekNumberElement(weekNumber));\n    }\n\n    return td;\n  };\n\n  Month.prototype.renderAppointmentContainer = function () {//Here needs to render mobile view appointment details on selected date\n  };\n\n  Month.prototype.renderDatesHeader = function () {\n    var container = createElement('div', {\n      className: cls.DATE_HEADER_CONTAINER_CLASS\n    });\n    var wrap = createElement('div', {\n      className: cls.DATE_HEADER_WRAP_CLASS\n    });\n    container.appendChild(wrap);\n    var table = this.createTableLayout();\n    this.createColGroup(table, this.colLevels[this.colLevels.length - 1]);\n    var trEle = createElement('tr');\n\n    for (var i = 0; i < this.colLevels.length; i++) {\n      var level = this.colLevels[i];\n      var ntr = trEle.cloneNode();\n\n      for (var j = 0; j < level.length; j++) {\n        var td = level[j];\n        ntr.appendChild(this.createHeaderCell(td));\n      }\n\n      table.querySelector('tbody').appendChild(ntr);\n    }\n\n    wrap.appendChild(table);\n    return container;\n  };\n\n  Month.prototype.createHeaderCell = function (td) {\n    var tdEle = createElement('td');\n    this.addAttributes(td, tdEle);\n\n    if (td.type === 'monthDay') {\n      var ele = createElement('span', {\n        innerHTML: util.capitalizeFirstWord(this.parent.getDayNames(this.dayNameFormat)[td.date.getDay()], 'single')\n      });\n      tdEle.appendChild(ele);\n    }\n\n    if (td.type === 'resourceHeader') {\n      this.setResourceHeaderContent(tdEle, td);\n    }\n\n    if (td.type === 'dateHeader') {\n      addClass([tdEle], cls.DATE_HEADER_CLASS);\n      tdEle.setAttribute('data-date', td.date.getTime().toString());\n\n      if (this.parent.activeViewOptions.dateHeaderTemplate) {\n        var dateValue = util.addLocalOffset(td.date);\n        var cellArgs = {\n          date: dateValue,\n          type: td.type\n        };\n        var elementId = this.parent.element.id + '_';\n        var viewName = this.parent.activeViewOptions.dateHeaderTemplateName;\n        var templateId = elementId + viewName + 'dateHeaderTemplate';\n        var dateTemplate = [].slice.call(this.parent.getDateHeaderTemplate()(cellArgs, this.parent, 'dateHeaderTemplate', templateId, false));\n\n        if (dateTemplate && dateTemplate.length) {\n          append(dateTemplate, tdEle);\n        }\n      } else {\n        var ele = createElement('span', {\n          className: cls.NAVIGATE_CLASS\n        });\n        var skeleton = 'full';\n        var title = this.parent.globalize.formatDate(td.date, {\n          skeleton: skeleton,\n          calendar: this.parent.getCalendarMode()\n        });\n        ele.setAttribute('title', util.capitalizeFirstWord(title, 'multiple'));\n        var innerText = this.parent.calendarUtil.isMonthStart(td.date) && !this.isCurrentDate(td.date) && !this.parent.isAdaptive ? this.parent.globalize.formatDate(td.date, {\n          format: 'MMM d',\n          calendar: this.parent.getCalendarMode()\n        }) : this.parent.globalize.formatDate(td.date, {\n          skeleton: 'd',\n          calendar: this.parent.getCalendarMode()\n        });\n        ele.innerHTML = util.capitalizeFirstWord(innerText, 'single');\n        tdEle.appendChild(ele);\n      }\n\n      this.wireCellEvents(tdEle);\n    }\n\n    var args = {\n      elementType: td.type,\n      element: tdEle,\n      date: td.date,\n      groupIndex: td.groupIndex\n    };\n    this.parent.trigger(event.renderCell, args);\n    return tdEle;\n  };\n\n  Month.prototype.getContentSlots = function () {\n    if (!(this.colLevels[this.colLevels.length - 1] && this.colLevels[this.colLevels.length - 1][0])) {\n      return [];\n    }\n\n    var slotDatas = [];\n\n    var prepareSlots = function (rowIndex, renderDate, resData, classList) {\n      var data = {\n        date: new Date(+renderDate),\n        groupIndex: resData.groupIndex,\n        workDays: resData.workDays,\n        type: 'monthCells',\n        className: classList || [cls.WORK_CELLS_CLASS]\n      };\n\n      if (!slotDatas[rowIndex]) {\n        slotDatas[rowIndex] = [];\n      }\n\n      slotDatas[rowIndex].push(data);\n    };\n\n    var includeResource = this.parent.currentView !== 'MonthAgenda' && this.parent.activeViewOptions.group.resources.length > 0;\n\n    if (includeResource && !this.parent.uiStateValues.isGroupAdaptive && !this.parent.activeViewOptions.group.byDate) {\n      for (var _i = 0, _a = this.colLevels[this.colLevels.length - 2]; _i < _a.length; _i++) {\n        var res = _a[_i];\n        var dates = res.renderDates.map(function (date) {\n          return new Date(+date);\n        });\n        var count = this.parent.activeViewOptions.showWeekend ? util.WEEK_LENGTH : res.workDays.length;\n\n        for (var i = 0; i < res.renderDates.length / count; i++) {\n          var colDates = dates.splice(0, count);\n\n          for (var _b = 0, colDates_1 = colDates; _b < colDates_1.length; _b++) {\n            var colDate = colDates_1[_b];\n            prepareSlots(i, colDate, res);\n          }\n        }\n      }\n    } else {\n      var dates = this.renderDates.map(function (date) {\n        return new Date(+date);\n      });\n      var count = this.parent.activeViewOptions.showWeekend ? util.WEEK_LENGTH : this.parent.activeViewOptions.workDays.length;\n\n      for (var i = 0; i < this.renderDates.length / count; i++) {\n        var colDates = dates.splice(0, count);\n\n        for (var _c = 0, colDates_2 = colDates; _c < colDates_2.length; _c++) {\n          var colDate = colDates_2[_c];\n\n          if (includeResource) {\n            var lastRow = this.colLevels[this.colLevels.length - 1];\n            var resourcesTd = lastRow.slice(0, lastRow.length / count);\n\n            for (var resIndex = 0; resIndex < resourcesTd.length; resIndex++) {\n              var clsList = void 0;\n\n              if (resIndex !== 0) {\n                clsList = [cls.WORK_CELLS_CLASS, cls.DISABLE_DATE];\n              }\n\n              prepareSlots(i, colDate, resourcesTd[resIndex], clsList);\n            }\n          } else {\n            prepareSlots(i, colDate, this.colLevels[this.colLevels.length - 1][0]);\n          }\n        }\n      }\n    }\n\n    return slotDatas;\n  };\n\n  Month.prototype.updateClassList = function (data) {\n    if (this.isOtherMonth(data.date)) {\n      data.className.push(cls.OTHERMONTH_CLASS);\n    }\n\n    if (!this.parent.isMinMaxDate(data.date)) {\n      data.className.push(cls.DISABLE_DATES);\n    }\n\n    if (this.parent.currentView === 'MonthAgenda' && this.parent.isSelectedDate(data.date)) {\n      data.className.push(cls.SELECTED_CELL_CLASS);\n    }\n  };\n\n  Month.prototype.isOtherMonth = function (date) {\n    return date.getTime() < this.monthDates.start.getTime() || date.getTime() > this.monthDates.end.getTime();\n  };\n\n  Month.prototype.renderContentArea = function () {\n    var tbl = this.createTableLayout(cls.CONTENT_TABLE_CLASS);\n    this.addAutoHeightClass(tbl);\n\n    if (this.parent.currentView === 'TimelineMonth') {\n      this.createColGroup(tbl, this.colLevels[this.colLevels.length - 1]);\n    }\n\n    var monthDate = new Date(this.parent.selectedDate.getTime());\n    this.monthDates = {\n      start: this.parent.calendarUtil.firstDateOfMonth(monthDate),\n      end: this.parent.calendarUtil.lastDateOfMonth(util.addMonths(monthDate, this.parent.activeViewOptions.interval - 1))\n    };\n    var tBody = tbl.querySelector('tbody');\n    append(this.getContentRows(), tBody);\n    this.wireCellEvents(tBody);\n    return tbl;\n  };\n\n  Month.prototype.getContentRows = function () {\n    var trows = [];\n    var tr = createElement('tr', {\n      attrs: {\n        role: 'row'\n      }\n    });\n    var td = createElement('td', {\n      attrs: {\n        role: 'gridcell',\n        'aria-selected': 'false'\n      }\n    });\n    var slotDatas = this.getContentSlots();\n\n    for (var row = 0; row < slotDatas.length; row++) {\n      var ntr = tr.cloneNode();\n\n      for (var col = 0; col < slotDatas[row].length; col++) {\n        var ntd = this.createContentTd(slotDatas[row][col], td);\n        ntr.appendChild(ntd);\n      }\n\n      trows.push(ntr);\n    }\n\n    return trows;\n  };\n\n  Month.prototype.createContentTd = function (data, td) {\n    var ntd = td.cloneNode();\n\n    if (data.colSpan) {\n      ntd.setAttribute('colspan', data.colSpan.toString());\n    }\n\n    this.updateClassList(data);\n    var type = data.type;\n\n    if (data.className.indexOf(cls.RESOURCE_PARENT_CLASS) !== -1) {\n      data.className.push(cls.RESOURCE_GROUP_CELLS_CLASS);\n      type = 'resourceGroupCells';\n    }\n\n    if (this.parent.workHours.highlight && this.isWorkDay(data.date, data.workDays)) {\n      data.className.push(cls.WORKDAY_CLASS);\n    }\n\n    if (this.isCurrentDate(data.date)) {\n      data.className.push(cls.CURRENTDATE_CLASS);\n    }\n\n    addClass([ntd], data.className);\n    ntd.setAttribute('data-date', data.date.getTime().toString());\n\n    if (!isNullOrUndefined(data.groupIndex) || this.parent.uiStateValues.isGroupAdaptive) {\n      var groupIndex = this.parent.uiStateValues.isGroupAdaptive ? this.parent.uiStateValues.groupIndex : data.groupIndex;\n      ntd.setAttribute('data-group-index', '' + groupIndex);\n    }\n\n    this.renderDateHeaderElement(data, ntd);\n\n    if (this.parent.activeViewOptions.cellTemplate) {\n      var dateValue = util.addLocalOffset(data.date);\n      var args_1 = {\n        date: dateValue,\n        type: type,\n        groupIndex: data.groupIndex\n      };\n      var scheduleId = this.parent.element.id + '_';\n      var viewName = this.parent.activeViewOptions.cellTemplateName;\n      var templateId = scheduleId + viewName + 'cellTemplate';\n      var cellTemplate = [].slice.call(this.parent.getCellTemplate()(args_1, this.parent, 'cellTemplate', templateId, false));\n      append(cellTemplate, ntd);\n    }\n\n    var args = {\n      elementType: type,\n      element: ntd,\n      date: data.date,\n      groupIndex: data.groupIndex\n    };\n    this.parent.trigger(event.renderCell, args);\n    return ntd;\n  };\n\n  Month.prototype.renderDateHeaderElement = function (data, ntd) {\n    if (this.parent.currentView === 'TimelineMonth') {\n      return;\n    }\n\n    var dateHeader = createElement('div', {\n      className: cls.DATE_HEADER_CLASS\n    });\n\n    if (this.parent.activeViewOptions.cellHeaderTemplate) {\n      var dateValue = util.addLocalOffset(data.date);\n      var args = {\n        date: dateValue,\n        type: data.type,\n        groupIndex: data.groupIndex\n      };\n      var scheduleId = this.parent.element.id + '_';\n      var viewName = this.parent.activeViewOptions.cellHeaderTemplateName;\n      var templateId = scheduleId + viewName + 'cellHeaderTemplate';\n      var cellheaderTemplate = [].slice.call(this.parent.getCellHeaderTemplate()(args, this.parent, 'cellHeaderTemplate', templateId, false));\n      append(cellheaderTemplate, dateHeader);\n    } else {\n      var innerText = this.parent.calendarUtil.isMonthStart(data.date) && !this.isCurrentDate(data.date) && !this.parent.isAdaptive ? this.parent.globalize.formatDate(data.date, {\n        format: 'MMM d',\n        calendar: this.parent.getCalendarMode()\n      }) : this.parent.globalize.formatDate(data.date, {\n        skeleton: 'd',\n        calendar: this.parent.getCalendarMode()\n      });\n      dateHeader.innerHTML = util.capitalizeFirstWord(innerText, 'single');\n    }\n\n    ntd.appendChild(dateHeader);\n\n    if (this.getModuleName() === 'month') {\n      addClass([dateHeader], cls.NAVIGATE_CLASS);\n      var skeleton = 'full';\n      var annocementText = this.parent.globalize.formatDate(data.date, {\n        skeleton: skeleton,\n        calendar: this.parent.getCalendarMode()\n      });\n      dateHeader.setAttribute('aria-label', annocementText);\n    }\n  };\n\n  Month.prototype.getMonthStart = function (currentDate) {\n    var monthStart = util.getWeekFirstDate(this.parent.calendarUtil.firstDateOfMonth(currentDate), this.parent.activeViewOptions.firstDayOfWeek);\n    var start = new Date(monthStart.getFullYear(), monthStart.getMonth(), monthStart.getDate());\n    return start;\n  };\n\n  Month.prototype.getMonthEnd = function (currentDate) {\n    var endDate = util.addMonths(currentDate, this.parent.activeViewOptions.interval - 1);\n    var lastWeekOfMonth = util.getWeekFirstDate(this.parent.calendarUtil.lastDateOfMonth(endDate), this.parent.activeViewOptions.firstDayOfWeek);\n    var monthEnd = util.addDays(lastWeekOfMonth, util.WEEK_LENGTH - 1);\n    return monthEnd;\n  };\n\n  Month.prototype.getRenderDates = function (workDays) {\n    var renderDates = [];\n    var currentDate = util.resetTime(this.parent.selectedDate);\n    var start = this.getMonthStart(currentDate);\n    var monthEnd = this.getMonthEnd(currentDate);\n\n    do {\n      if (this.parent.activeViewOptions.showWeekend) {\n        renderDates.push(start);\n      } else {\n        if (this.isWorkDay(start, workDays)) {\n          renderDates.push(start);\n        }\n      }\n\n      start = util.addDays(start, 1);\n\n      if (start.getHours() > 0) {\n        start = util.resetTime(start);\n      }\n    } while (start.getTime() <= monthEnd.getTime());\n\n    if (!workDays) {\n      this.renderDates = renderDates;\n    }\n\n    if (this.parent.headerModule) {\n      this.parent.headerModule.previousNextIconHandler();\n    }\n\n    return renderDates;\n  };\n\n  Month.prototype.getNextPreviousDate = function (type) {\n    if (type === 'next') {\n      return util.addMonths(this.parent.selectedDate, this.parent.activeViewOptions.interval);\n    } else {\n      return util.addMonths(this.parent.selectedDate, -this.parent.activeViewOptions.interval);\n    }\n  };\n\n  Month.prototype.getEndDateFromStartDate = function (start) {\n    return util.addDays(new Date(start.getTime()), 1);\n  };\n\n  Month.prototype.getDateRangeText = function () {\n    if (this.parent.isAdaptive || isNullOrUndefined(this.parent.activeViewOptions.dateFormat)) {\n      if (this.parent.activeViewOptions.interval > 1) {\n        var endDate = util.addMonths(util.lastDateOfMonth(this.parent.selectedDate), this.parent.activeViewOptions.interval - 1);\n\n        if (this.parent.selectedDate.getFullYear() === endDate.getFullYear()) {\n          var monthNames = this.parent.globalize.formatDate(this.parent.selectedDate, {\n            format: 'MMMM',\n            calendar: this.parent.getCalendarMode()\n          }) + ' - ' + this.parent.globalize.formatDate(endDate, {\n            format: 'MMMM ',\n            calendar: this.parent.getCalendarMode()\n          }) + endDate.getFullYear();\n          return util.capitalizeFirstWord(monthNames, 'single');\n        }\n\n        var text = this.parent.globalize.formatDate(this.parent.selectedDate, {\n          format: 'MMMM',\n          calendar: this.parent.getCalendarMode()\n        }) + ' ' + this.parent.selectedDate.getFullYear() + ' - ' + this.parent.globalize.formatDate(endDate, {\n          format: 'MMMM ',\n          calendar: this.parent.getCalendarMode()\n        }) + endDate.getFullYear();\n        return util.capitalizeFirstWord(text, 'single');\n      }\n\n      var format = this.parent.activeViewOptions.dateFormat ? this.parent.activeViewOptions.dateFormat : 'MMMM y';\n      return util.capitalizeFirstWord(this.parent.globalize.formatDate(this.parent.selectedDate, {\n        format: format,\n        calendar: this.parent.getCalendarMode()\n      }), 'single');\n    }\n\n    return this.formatDateRange(this.parent.selectedDate);\n  };\n\n  Month.prototype.getLabelText = function (view) {\n    return this.parent.localeObj.getConstant(view) + ' of ' + util.capitalizeFirstWord(this.parent.globalize.formatDate(this.parent.selectedDate, {\n      format: 'MMMM y',\n      calendar: this.parent.getCalendarMode()\n    }), 'single');\n  };\n\n  Month.prototype.createWeekNumberElement = function (text) {\n    var tr = createElement('tr');\n    var td = createElement('td', {\n      className: cls.WEEK_NUMBER_CLASS,\n      attrs: {\n        'title': text ? this.parent.localeObj.getConstant('week') + ' ' + text : ''\n      },\n      innerHTML: text || ''\n    });\n    tr.appendChild(td);\n    var args = {\n      elementType: 'weekNumberCell',\n      element: td\n    };\n    this.parent.trigger(event.renderCell, args);\n    return tr;\n  };\n\n  Month.prototype.unwireEvents = function () {// No scroller events for month view\n  };\n  /**\r\n   * Get module name.\r\n   */\n\n\n  Month.prototype.getModuleName = function () {\n    return 'month';\n  };\n  /**\r\n   * To destroy the month.\r\n   * @return {void}\r\n   * @private\r\n   */\n\n\n  Month.prototype.destroy = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    if (this.element) {\n      this.unwireEvents();\n\n      if (this.parent.resourceBase) {\n        this.parent.resourceBase.destroy();\n      }\n\n      remove(this.element);\n      this.element = null;\n\n      if (this.parent.scheduleTouchModule) {\n        this.parent.scheduleTouchModule.resetValues();\n      }\n    }\n  };\n\n  return Month;\n}(ViewBase);\n\nexport { Month };","map":{"version":3,"sources":["C:/Users/User/volunteers/node_modules/@syncfusion/ej2-schedule/src/schedule/renderer/month.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","EventHandler","formatUnit","isNullOrUndefined","createElement","remove","addClass","removeClass","append","prepend","ViewBase","MonthEvent","util","event","cls","Month","_super","parent","_this","call","dayNameFormat","viewClass","isInverseTableSelect","monthDates","addEventListener","on","scrollUiUpdate","onScrollUIUpdate","dataReady","onDataReady","cellClick","onCellClick","removeEventListener","off","args","monthEvent","renderAppointments","notify","eventsLoaded","onContentScroll","e","removeNewEventElement","virtualScroll","scrollTopPanel","target","scrollLeftPanel","setPersistence","leftPanel","getLeftPanelElement","scrollTop","element","querySelector","WEEK_NUMBER_WRAPPER_CLASS","headerHeight","getHeaderBarHeight","header","getDatesHeaderElement","content","getContentAreaElement","height","offsetHeight","setContentHeight","scrollBarWidth","getScrollBarWidth","firstElementChild","style","cssProperties","rtlBorder","rtlPadding","offsetWidth","clientWidth","border","padding","setColWidth","scrollPosition","top","scrollLeft","left","headerCell","document","HEADER_CELLS_CLASS","getMsFromDate","selectedDate","offsetLeft","retainScrollPosition","leftPanelElement","currentView","CONTENT_TABLE_CLASS","getScrollXIndent","generateColumnLevels","colLevels","level","getDateSlots","renderDates","activeViewOptions","workDays","group","resources","length","resourceBase","generateResourceLevels","uiStateValues","isGroupAdaptive","lastResourceLevel","resourceLevel","groupIndex","push","count","showWeekend","WEEK_LENGTH","dateSlots","col","classList","currentDateIndex","slice","map","date","getDay","isCurrentMonth","indexOf","getCurrentTime","CURRENT_DAY_CLASS","type","className","colSpan","getDayNameFormat","isAdaptive","serverRenderLayout","curElem","querySelectorAll","curDate","addLocalOffset","Date","setHours","queryString","WORK_CELLS_CLASS","getTime","toString","CURRENTDATE_CLASS","curEle","_i","curEle_1","ele","index","cellIndex","curHeader","setPanel","TABLE_WRAP_CLASS","activeView","getPanel","headerCells","DATE_HEADER_WRAP_CLASS","_a","headerCells_1","cell","clearEvents","wireCellEvents","contentBody","virtualScrollModule","setTranslateValue","wrap","CONTENT_WRAP_CLASS","add","wireExpandCollapseIconEvents","renderAppointmentContainer","RESOURCE_TOOLBAR_CONTAINER","renderResourceMobileLayout","contentReady","renderLayout","isServerRenderer","isTimelineView","setRenderedResources","clsList","byDate","allowVirtualScrolling","VIRTUAL_SCROLL_CLASS","eventSettings","ignoreWhitespace","IGNORE_WHITESPACE","renderPanel","appendChild","createTableLayout","OUTER_TABLE_CLASS","setAttribute","renderHeader","renderContent","workCellAction","cellMouseDown","cellDblClick","tr","renderLeftIndent","dateTd","renderDatesHeader","showWeekNumber","renderWeekNumberContent","workTd","contentArea","renderContentArea","monthAgendaWrapper","TABLE_CONTAINER_CLASS","dateCol","td","contentWrapper","contentWrapTable","noOfDays","i","length_1","dates","splice","weekNumber","getWeekNumberContent","createWeekNumberElement","container","DATE_HEADER_CONTAINER_CLASS","table","createColGroup","trEle","ntr","cloneNode","j","createHeaderCell","tdEle","addAttributes","innerHTML","capitalizeFirstWord","getDayNames","setResourceHeaderContent","DATE_HEADER_CLASS","dateHeaderTemplate","dateValue","cellArgs","elementId","id","viewName","dateHeaderTemplateName","templateId","dateTemplate","getDateHeaderTemplate","NAVIGATE_CLASS","skeleton","title","globalize","formatDate","calendar","getCalendarMode","innerText","calendarUtil","isMonthStart","isCurrentDate","format","elementType","trigger","renderCell","getContentSlots","slotDatas","prepareSlots","rowIndex","renderDate","resData","data","includeResource","res","colDates","_b","colDates_1","colDate","_c","colDates_2","lastRow","resourcesTd","resIndex","DISABLE_DATE","updateClassList","isOtherMonth","OTHERMONTH_CLASS","isMinMaxDate","DISABLE_DATES","isSelectedDate","SELECTED_CELL_CLASS","start","end","tbl","addAutoHeightClass","monthDate","firstDateOfMonth","lastDateOfMonth","addMonths","interval","tBody","getContentRows","trows","attrs","role","row","ntd","createContentTd","RESOURCE_PARENT_CLASS","RESOURCE_GROUP_CELLS_CLASS","workHours","highlight","isWorkDay","WORKDAY_CLASS","renderDateHeaderElement","cellTemplate","args_1","scheduleId","cellTemplateName","getCellTemplate","dateHeader","cellHeaderTemplate","cellHeaderTemplateName","cellheaderTemplate","getCellHeaderTemplate","getModuleName","annocementText","getMonthStart","currentDate","monthStart","getWeekFirstDate","firstDayOfWeek","getFullYear","getMonth","getDate","getMonthEnd","endDate","lastWeekOfMonth","monthEnd","addDays","getRenderDates","resetTime","getHours","headerModule","previousNextIconHandler","getNextPreviousDate","getEndDateFromStartDate","getDateRangeText","dateFormat","monthNames","text","formatDateRange","getLabelText","view","localeObj","getConstant","WEEK_NUMBER_CLASS","unwireEvents","destroy","isDestroyed","scheduleTouchModule","resetValues"],"mappings":"AAAA,IAAIA,SAAS,GAAI,QAAQ,KAAKA,SAAd,IAA6B,YAAY;AACrD,MAAIC,aAAa,GAAG,UAAUC,CAAV,EAAaC,CAAb,EAAgB;AAChCF,IAAAA,aAAa,GAAGG,MAAM,CAACC,cAAP,IACX;AAAEC,MAAAA,SAAS,EAAE;AAAb,iBAA6BC,KAA7B,IAAsC,UAAUL,CAAV,EAAaC,CAAb,EAAgB;AAAED,MAAAA,CAAC,CAACI,SAAF,GAAcH,CAAd;AAAkB,KAD/D,IAEZ,UAAUD,CAAV,EAAaC,CAAb,EAAgB;AAAE,WAAK,IAAIK,CAAT,IAAcL,CAAd,EAAiB,IAAIA,CAAC,CAACM,cAAF,CAAiBD,CAAjB,CAAJ,EAAyBN,CAAC,CAACM,CAAD,CAAD,GAAOL,CAAC,CAACK,CAAD,CAAR;AAAc,KAF9E;;AAGA,WAAOP,aAAa,CAACC,CAAD,EAAIC,CAAJ,CAApB;AACH,GALD;;AAMA,SAAO,UAAUD,CAAV,EAAaC,CAAb,EAAgB;AACnBF,IAAAA,aAAa,CAACC,CAAD,EAAIC,CAAJ,CAAb;;AACA,aAASO,EAAT,GAAc;AAAE,WAAKC,WAAL,GAAmBT,CAAnB;AAAuB;;AACvCA,IAAAA,CAAC,CAACU,SAAF,GAAcT,CAAC,KAAK,IAAN,GAAaC,MAAM,CAACS,MAAP,CAAcV,CAAd,CAAb,IAAiCO,EAAE,CAACE,SAAH,GAAeT,CAAC,CAACS,SAAjB,EAA4B,IAAIF,EAAJ,EAA7D,CAAd;AACH,GAJD;AAKH,CAZ2C,EAA5C;;AAaA,SAASI,YAAT,EAAuBC,UAAvB,EAAmCC,iBAAnC,QAA4D,sBAA5D;AACA,SAASC,aAAT,EAAwBC,MAAxB,EAAgCC,QAAhC,EAA0CC,WAA1C,EAAuDC,MAAvD,EAA+DC,OAA/D,QAA8E,sBAA9E;AACA,SAASC,QAAT,QAAyB,aAAzB;AACA,SAASC,UAAT,QAA2B,yBAA3B;AACA,OAAO,KAAKC,IAAZ,MAAsB,cAAtB;AACA,OAAO,KAAKC,KAAZ,MAAuB,kBAAvB;AACA,OAAO,KAAKC,GAAZ,MAAqB,sBAArB;AACA;AACA;AACA;;AACA,IAAIC,KAAK;AAAG;AAAe,UAAUC,MAAV,EAAkB;AACzC7B,EAAAA,SAAS,CAAC4B,KAAD,EAAQC,MAAR,CAAT;AACA;AACJ;AACA;;;AACI,WAASD,KAAT,CAAeE,MAAf,EAAuB;AACnB,QAAIC,KAAK,GAAGF,MAAM,CAACG,IAAP,CAAY,IAAZ,EAAkBF,MAAlB,KAA6B,IAAzC;;AACAC,IAAAA,KAAK,CAACE,aAAN,GAAsB,MAAtB;AACAF,IAAAA,KAAK,CAACG,SAAN,GAAkB,cAAlB;AACAH,IAAAA,KAAK,CAACI,oBAAN,GAA6B,KAA7B;AACAJ,IAAAA,KAAK,CAACK,UAAN,GAAmB,EAAnB;AACA,WAAOL,KAAP;AACH;;AACDH,EAAAA,KAAK,CAAChB,SAAN,CAAgByB,gBAAhB,GAAmC,YAAY;AAC3C,SAAKP,MAAL,CAAYQ,EAAZ,CAAeZ,KAAK,CAACa,cAArB,EAAqC,KAAKC,gBAA1C,EAA4D,IAA5D;AACA,SAAKV,MAAL,CAAYQ,EAAZ,CAAeZ,KAAK,CAACe,SAArB,EAAgC,KAAKC,WAArC,EAAkD,IAAlD;AACA,SAAKZ,MAAL,CAAYQ,EAAZ,CAAeZ,KAAK,CAACiB,SAArB,EAAgC,KAAKC,WAArC,EAAkD,IAAlD;AACH,GAJD;;AAKAhB,EAAAA,KAAK,CAAChB,SAAN,CAAgBiC,mBAAhB,GAAsC,YAAY;AAC9C,SAAKf,MAAL,CAAYgB,GAAZ,CAAgBpB,KAAK,CAACa,cAAtB,EAAsC,KAAKC,gBAA3C;AACA,SAAKV,MAAL,CAAYgB,GAAZ,CAAgBpB,KAAK,CAACe,SAAtB,EAAiC,KAAKC,WAAtC;AACA,SAAKZ,MAAL,CAAYgB,GAAZ,CAAgBpB,KAAK,CAACiB,SAAtB,EAAiC,KAAKC,WAAtC;AACH,GAJD;;AAKAhB,EAAAA,KAAK,CAAChB,SAAN,CAAgB8B,WAAhB,GAA8B,UAAUK,IAAV,EAAgB;AAC1C,QAAIC,UAAU,GAAG,IAAIxB,UAAJ,CAAe,KAAKM,MAApB,CAAjB;AACAkB,IAAAA,UAAU,CAACC,kBAAX;AACA,SAAKnB,MAAL,CAAYoB,MAAZ,CAAmBxB,KAAK,CAACyB,YAAzB,EAAuC,EAAvC;AACH,GAJD;;AAKAvB,EAAAA,KAAK,CAAChB,SAAN,CAAgBgC,WAAhB,GAA8B,UAAUlB,KAAV,EAAiB,CAC3C;AACH,GAFD;;AAGAE,EAAAA,KAAK,CAAChB,SAAN,CAAgBwC,eAAhB,GAAkC,UAAUC,CAAV,EAAa;AAC3C,SAAKvB,MAAL,CAAYwB,qBAAZ;AACA,SAAKxB,MAAL,CAAYoB,MAAZ,CAAmBxB,KAAK,CAAC6B,aAAzB,EAAwCF,CAAxC;AACA,SAAKG,cAAL,CAAoBH,CAAC,CAACI,MAAtB;AACA,SAAKC,eAAL,CAAqBL,CAAC,CAACI,MAAvB;AACA,SAAKE,cAAL;AACH,GAND;;AAOA/B,EAAAA,KAAK,CAAChB,SAAN,CAAgB8C,eAAhB,GAAkC,UAAUD,MAAV,EAAkB;AAChD,QAAIG,SAAS,GAAG,KAAKC,mBAAL,EAAhB;;AACA,QAAID,SAAJ,EAAe;AACXA,MAAAA,SAAS,CAACE,SAAV,GAAsBL,MAAM,CAACK,SAA7B;AACH;AACJ,GALD;;AAMAlC,EAAAA,KAAK,CAAChB,SAAN,CAAgBiD,mBAAhB,GAAsC,YAAY;AAC9C,WAAO,KAAKE,OAAL,CAAaC,aAAb,CAA2B,MAAMrC,GAAG,CAACsC,yBAArC,CAAP;AACH,GAFD;;AAGArC,EAAAA,KAAK,CAAChB,SAAN,CAAgB4B,gBAAhB,GAAmC,UAAUO,IAAV,EAAgB;AAC/C,QAAImB,YAAY,GAAG,KAAKC,kBAAL,EAAnB;AACA,QAAIC,MAAM,GAAG,KAAKC,qBAAL,EAAb;AACA,QAAIC,OAAO,GAAG,KAAKC,qBAAL,EAAd;AACA,QAAIC,MAAM,GAAG,KAAK1C,MAAL,CAAYiC,OAAZ,CAAoBU,YAApB,GAAmCP,YAAnC,GAAkDE,MAAM,CAACK,YAAtE;AACA,QAAIb,SAAS,GAAG,KAAKC,mBAAL,EAAhB;AACA,SAAKa,gBAAL,CAAsBJ,OAAtB,EAA+BV,SAA/B,EAA0CY,MAA1C;AACA,QAAIG,cAAc,GAAGlD,IAAI,CAACmD,iBAAL,EAArB,CAP+C,CAQ/C;;AACAR,IAAAA,MAAM,CAACS,iBAAP,CAAyBC,KAAzB,CAA+B/B,IAAI,CAACgC,aAAL,CAAmBC,SAAlD,IAA+D,EAA/D;AACAZ,IAAAA,MAAM,CAACU,KAAP,CAAa/B,IAAI,CAACgC,aAAL,CAAmBE,UAAhC,IAA8C,EAA9C;;AACA,QAAIX,OAAO,CAACY,WAAR,GAAsBZ,OAAO,CAACa,WAA9B,GAA4C,CAAhD,EAAmD;AAC/Cf,MAAAA,MAAM,CAACS,iBAAP,CAAyBC,KAAzB,CAA+B/B,IAAI,CAACgC,aAAL,CAAmBK,MAAlD,IAA4DT,cAAc,GAAG,CAAjB,GAAqB,KAArB,GAA6B,KAAzF;AACAP,MAAAA,MAAM,CAACU,KAAP,CAAa/B,IAAI,CAACgC,aAAL,CAAmBM,OAAhC,IAA2CV,cAAc,GAAG,CAAjB,GAAqBA,cAAc,GAAG,CAAjB,GAAqB,IAA1C,GAAiD,KAA5F;AACH,KAHD,MAIK;AACDP,MAAAA,MAAM,CAACS,iBAAP,CAAyBC,KAAzB,CAA+B/B,IAAI,CAACgC,aAAL,CAAmBK,MAAlD,IAA4D,EAA5D;AACAhB,MAAAA,MAAM,CAACU,KAAP,CAAa/B,IAAI,CAACgC,aAAL,CAAmBM,OAAhC,IAA2C,EAA3C;AACH,KAlB8C,CAmB/C;;;AACA,SAAKC,WAAL,CAAiBhB,OAAjB;;AACA,QAAIvB,IAAI,CAACwC,cAAT,EAAyB;AACrB,UAAI3B,SAAJ,EAAe;AACXA,QAAAA,SAAS,CAACE,SAAV,GAAsBf,IAAI,CAACwC,cAAL,CAAoBC,GAA1C;AACH;;AACDlB,MAAAA,OAAO,CAACR,SAAR,GAAoBf,IAAI,CAACwC,cAAL,CAAoBC,GAAxC;AACAlB,MAAAA,OAAO,CAACmB,UAAR,GAAqB1C,IAAI,CAACwC,cAAL,CAAoBG,IAAzC;AACH,KAND,MAOK;AACD,UAAIC,UAAU,GAAGC,QAAQ,CAAC5B,aAAT,CAAuB,MAAMrC,GAAG,CAACkE,kBAAV,GAA+B,cAA/B,GAClC,KAAK/D,MAAL,CAAYgE,aAAZ,CAA0B,KAAKhE,MAAL,CAAYiE,YAAtC,CADkC,GACoB,IAD3C,CAAjB;AAEAzB,MAAAA,OAAO,CAACmB,UAAR,GAAqBE,UAAU,KAAK,IAAf,GAAsBA,UAAU,CAACK,UAAjC,GAA8C,CAAnE;AACH;;AACD,SAAKC,oBAAL;AACH,GAlCD;;AAmCArE,EAAAA,KAAK,CAAChB,SAAN,CAAgB8D,gBAAhB,GAAmC,UAAUJ,OAAV,EAAmB4B,gBAAnB,EAAqC1B,MAArC,EAA6C;AAC5EF,IAAAA,OAAO,CAACQ,KAAR,CAAcN,MAAd,GAAuB,MAAvB;;AACA,QAAI,KAAK1C,MAAL,CAAYqE,WAAZ,KAA4B,OAAhC,EAAyC;AACrC7B,MAAAA,OAAO,CAACQ,KAAR,CAAcN,MAAd,GAAuBzD,UAAU,CAACyD,MAAD,CAAjC;AACH;;AACD,QAAI0B,gBAAJ,EAAsB;AAClB,UAAI,KAAKpE,MAAL,CAAYqE,WAAZ,KAA4B,aAAhC,EAA+C;AAC3C3B,QAAAA,MAAM,GAAG,KAAKT,OAAL,CAAaC,aAAb,CAA2B,MAAMrC,GAAG,CAACyE,mBAArC,EAA0D3B,YAAnE;AACH;;AACDyB,MAAAA,gBAAgB,CAACpB,KAAjB,CAAuBN,MAAvB,GAAgC,MAAhC;AACA0B,MAAAA,gBAAgB,CAACpB,KAAjB,CAAuBN,MAAvB,GAAgCzD,UAAU,CAACyD,MAAM,GAAG,KAAK6B,gBAAL,CAAsB/B,OAAtB,CAAV,CAA1C;AACH;AACJ,GAZD;;AAaA1C,EAAAA,KAAK,CAAChB,SAAN,CAAgB0F,oBAAhB,GAAuC,YAAY;AAC/C,QAAIC,SAAS,GAAG,EAAhB;AACA,QAAIC,KAAK,GAAG,KAAKC,YAAL,CAAkB,KAAKC,WAAvB,EAAoC,KAAK5E,MAAL,CAAY6E,iBAAZ,CAA8BC,QAAlE,CAAZ;;AACA,QAAI,KAAK9E,MAAL,CAAY6E,iBAAZ,CAA8BE,KAA9B,CAAoCC,SAApC,CAA8CC,MAA9C,GAAuD,CAA3D,EAA8D;AAC1DR,MAAAA,SAAS,GAAG,KAAKzE,MAAL,CAAYkF,YAAZ,CAAyBC,sBAAzB,CAAgDT,KAAhD,CAAZ;;AACA,UAAI,KAAK1E,MAAL,CAAYqE,WAAZ,KAA4B,aAAhC,EAA+C;AAC3CI,QAAAA,SAAS,GAAG,CAACC,KAAD,CAAZ;AACH;;AACD,UAAI,KAAK1E,MAAL,CAAYoF,aAAZ,CAA0BC,eAA1B,IAA6C,KAAKrF,MAAL,CAAYkF,YAAZ,CAAyBI,iBAAzB,CAA2CL,MAA3C,GAAoD,CAArG,EAAwG;AACpG,YAAIM,aAAa,GAAG,KAAKvF,MAAL,CAAYkF,YAAZ,CAAyBI,iBAAzB,CAA2C,KAAKtF,MAAL,CAAYoF,aAAZ,CAA0BI,UAArE,CAApB;AACAf,QAAAA,SAAS,GAAG,CAAC,KAAKE,YAAL,CAAkBY,aAAa,CAACX,WAAhC,EAA6CW,aAAa,CAACT,QAA3D,CAAD,CAAZ;AACH;AACJ,KATD,MAUK;AACDL,MAAAA,SAAS,CAACgB,IAAV,CAAef,KAAf;AACH;;AACD,SAAKD,SAAL,GAAiBA,SAAjB;AACA,WAAOA,SAAP;AACH,GAlBD;;AAmBA3E,EAAAA,KAAK,CAAChB,SAAN,CAAgB6F,YAAhB,GAA+B,UAAUC,WAAV,EAAuBE,QAAvB,EAAiC;AAC5D,QAAIY,KAAK,GAAG,KAAK1F,MAAL,CAAY6E,iBAAZ,CAA8Bc,WAA9B,GAA4ChG,IAAI,CAACiG,WAAjD,GAA+Dd,QAAQ,CAACG,MAApF;AACA,QAAIY,SAAS,GAAG,EAAhB;;AACA,SAAK,IAAIC,GAAG,GAAG,CAAf,EAAkBA,GAAG,GAAGJ,KAAxB,EAA+BI,GAAG,EAAlC,EAAsC;AAClC,UAAIC,SAAS,GAAG,CAAClG,GAAG,CAACkE,kBAAL,CAAhB;AACA,UAAIiC,gBAAgB,GAAGpB,WAAW,CAACqB,KAAZ,CAAkB,CAAlB,EAAqBP,KAArB,EAA4BQ,GAA5B,CAAgC,UAAUC,IAAV,EAAgB;AAAE,eAAOA,IAAI,CAACC,MAAL,EAAP;AAAuB,OAAzE,CAAvB;;AACA,UAAI,KAAKC,cAAL,CAAoB,KAAKrG,MAAL,CAAYiE,YAAhC,KAAiD+B,gBAAgB,CAACM,OAAjB,CAAyB,KAAKtG,MAAL,CAAYuG,cAAZ,GAA6BH,MAA7B,EAAzB,MAAoEN,GAAzH,EAA8H;AAC1HC,QAAAA,SAAS,CAACN,IAAV,CAAe5F,GAAG,CAAC2G,iBAAnB;AACH;;AACDX,MAAAA,SAAS,CAACJ,IAAV,CAAe;AAAEU,QAAAA,IAAI,EAAEvB,WAAW,CAACkB,GAAD,CAAnB;AAA0BW,QAAAA,IAAI,EAAE,UAAhC;AAA4CC,QAAAA,SAAS,EAAEX,SAAvD;AAAkEY,QAAAA,OAAO,EAAE,CAA3E;AAA8E7B,QAAAA,QAAQ,EAAEA;AAAxF,OAAf;AACH;;AACD,WAAOe,SAAP;AACH,GAZD;;AAaA/F,EAAAA,KAAK,CAAChB,SAAN,CAAgB8H,gBAAhB,GAAmC,YAAY;AAC3C,QAAI,KAAK5G,MAAL,CAAY6G,UAAZ,IAA0B,KAAK7G,MAAL,CAAY6E,iBAAZ,CAA8BE,KAA9B,CAAoCC,SAApC,CAA8CC,MAA9C,GAAuD,CAArF,EAAwF;AACpF,aAAO,aAAP;AACH;;AACD,WAAO,MAAP;AACH,GALD;;AAMAnF,EAAAA,KAAK,CAAChB,SAAN,CAAgBgI,kBAAhB,GAAqC,YAAY;AAC7C,QAAIC,OAAO,GAAG,GAAGd,KAAH,CAAS/F,IAAT,CAAc,KAAKF,MAAL,CAAYiC,OAAZ,CAAoB+E,gBAApB,CAAqC,MAAMnH,GAAG,CAAC2G,iBAA/C,CAAd,CAAd;;AACA,QAAIO,OAAO,CAAC9B,MAAR,GAAiB,CAArB,EAAwB;AACpB3F,MAAAA,WAAW,CAACyH,OAAD,EAAUlH,GAAG,CAAC2G,iBAAd,CAAX;AACH;;AACD,QAAIS,OAAO,GAAGtH,IAAI,CAACuH,cAAL,CAAoB,IAAIC,IAAJ,CAAS,IAAIA,IAAJ,GAAWC,QAAX,CAAoB,CAApB,EAAuB,CAAvB,EAA0B,CAA1B,EAA6B,CAA7B,CAAT,CAApB,CAAd;AACA,QAAIC,WAAW,GAAG,MAAMxH,GAAG,CAACyH,gBAAV,GAA6B,cAA7B,GAA8CL,OAAO,CAACM,OAAR,GAAkBC,QAAlB,EAA9C,GAA6E,IAA/F;;AACA,QAAI,KAAKxH,MAAL,CAAYqE,WAAZ,KAA4B,OAA5B,IAAuC,KAAKrE,MAAL,CAAYqE,WAAZ,KAA4B,aAAvE,EAAsF;AAClF0C,MAAAA,OAAO,GAAG,GAAGd,KAAH,CAAS/F,IAAT,CAAc,KAAKF,MAAL,CAAYiC,OAAZ,CAAoB+E,gBAApB,CAAqC,MAAMnH,GAAG,CAAC4H,iBAA/C,CAAd,CAAV;;AACA,UAAIV,OAAO,CAAC9B,MAAR,GAAiB,CAArB,EAAwB;AACpB3F,QAAAA,WAAW,CAACyH,OAAD,EAAUlH,GAAG,CAAC4H,iBAAd,CAAX;AACH;;AACD,UAAIC,MAAM,GAAG,GAAGzB,KAAH,CAAS/F,IAAT,CAAc,KAAKF,MAAL,CAAYiC,OAAZ,CAAoB+E,gBAApB,CAAqCK,WAArC,CAAd,CAAb;;AACA,WAAK,IAAIM,EAAE,GAAG,CAAT,EAAYC,QAAQ,GAAGF,MAA5B,EAAoCC,EAAE,GAAGC,QAAQ,CAAC3C,MAAlD,EAA0D0C,EAAE,EAA5D,EAAgE;AAC5D,YAAIE,GAAG,GAAGD,QAAQ,CAACD,EAAD,CAAlB;AACA,YAAIG,KAAK,GAAGD,GAAG,CAACE,SAAhB;AACA,YAAIC,SAAS,GAAG,GAAG/B,KAAH,CAAS/F,IAAT,CAAc,KAAKF,MAAL,CAAYiC,OAAZ,CAAoB+E,gBAApB,CAAqC,MAAMnH,GAAG,CAACkE,kBAA/C,CAAd,EAAkF+D,KAAlF,CAAhB;AACAzI,QAAAA,QAAQ,CAAC,CAACwI,GAAD,CAAD,EAAQhI,GAAG,CAAC4H,iBAAZ,CAAR;AACApI,QAAAA,QAAQ,CAAC,CAAC2I,SAAD,CAAD,EAAcnI,GAAG,CAAC2G,iBAAlB,CAAR;AACH;AACJ;;AACD,QAAI,KAAKxG,MAAL,CAAYqE,WAAZ,KAA4B,eAAhC,EAAiD;AAC7C,UAAIqD,MAAM,GAAG,KAAK1H,MAAL,CAAYiC,OAAZ,CAAoBC,aAApB,CAAkC,MAAMrC,GAAG,CAACkE,kBAAV,GAA+B,cAA/B,GAAgDkD,OAAO,CAACM,OAAR,GAAkBC,QAAlB,EAAhD,GAA+E,IAAjH,CAAb;;AACA,UAAI,CAACtI,iBAAiB,CAACwI,MAAD,CAAtB,EAAgC;AAC5BrI,QAAAA,QAAQ,CAAC,CAACqI,MAAD,CAAD,EAAW7H,GAAG,CAAC2G,iBAAf,CAAR;AACH;AACJ;;AACD,SAAKyB,QAAL,CAAc,KAAKjI,MAAL,CAAYiC,OAAZ,CAAoBC,aAApB,CAAkC,MAAMrC,GAAG,CAACqI,gBAA5C,CAAd;AACA,QAAIvG,MAAM,GAAI,KAAK3B,MAAL,CAAYqE,WAAZ,KAA4B,aAA7B,GAA8C,KAAKrE,MAAL,CAAYmI,UAAZ,CAAuBC,QAAvB,EAA9C,GAAkF,KAAKpI,MAAL,CAAYiC,OAA3G;AACA,QAAIoG,WAAW,GAAG,GAAGpC,KAAH,CAAS/F,IAAT,CAAc,KAAK+B,OAAL,CAAa+E,gBAAb,CAA8B,MAAMnH,GAAG,CAACyI,sBAAV,GAAmC,MAAnC,GAA4CzI,GAAG,CAACkE,kBAA9E,CAAd,CAAlB;;AACA,SAAK,IAAIwE,EAAE,GAAG,CAAT,EAAYC,aAAa,GAAGH,WAAjC,EAA8CE,EAAE,GAAGC,aAAa,CAACvD,MAAjE,EAAyEsD,EAAE,EAA3E,EAA+E;AAC3E,UAAIE,IAAI,GAAGD,aAAa,CAACD,EAAD,CAAxB;AACAvJ,MAAAA,YAAY,CAAC0J,WAAb,CAAyBD,IAAzB;AACA,WAAKE,cAAL,CAAoBF,IAApB;AACH;;AACD,QAAIG,WAAW,GAAG,KAAK3G,OAAL,CAAaC,aAAb,CAA2B,MAAMrC,GAAG,CAACyE,mBAAV,GAAgC,QAA3D,CAAlB;AACAtF,IAAAA,YAAY,CAAC0J,WAAb,CAAyBE,WAAzB;AACA,SAAKD,cAAL,CAAoBC,WAApB;;AACA,QAAI,KAAK5I,MAAL,CAAY6I,mBAAhB,EAAqC;AACjC,WAAK7I,MAAL,CAAY6I,mBAAZ,CAAgCC,iBAAhC;AACH;;AACD,QAAIC,IAAI,GAAG,KAAK9G,OAAL,CAAaC,aAAb,CAA2B,MAAMrC,GAAG,CAACmJ,kBAArC,CAAX;AACAhK,IAAAA,YAAY,CAAC0J,WAAb,CAAyBK,IAAzB;AACA/J,IAAAA,YAAY,CAACiK,GAAb,CAAiBF,IAAjB,EAAuB,QAAvB,EAAiC,KAAKzH,eAAtC,EAAuD,IAAvD;AACA,SAAK4H,4BAAL;AACA,SAAKC,0BAAL;;AACA,QAAI,KAAKnJ,MAAL,CAAYoF,aAAZ,CAA0BC,eAA1B,IAA6C,CAAC1D,MAAM,CAACO,aAAP,CAAqB,MAAMrC,GAAG,CAACuJ,0BAA/B,CAAlD,EAA8G;AAC1G,WAAKC,0BAAL;AACH;;AACD,SAAKrJ,MAAL,CAAYoB,MAAZ,CAAmBxB,KAAK,CAAC0J,YAAzB,EAAuC,EAAvC;AACH,GAlDD;;AAmDAxJ,EAAAA,KAAK,CAAChB,SAAN,CAAgByK,YAAhB,GAA+B,UAAU9C,IAAV,EAAgB;AAC3C,SAAKtG,aAAL,GAAqB,KAAKyG,gBAAL,EAArB;;AACA,QAAI,KAAK5G,MAAL,CAAYwJ,gBAAZ,EAAJ,EAAoC;AAChC,WAAK/E,SAAL,GAAiB,KAAKD,oBAAL,EAAjB;;AACA,UAAI,KAAKxE,MAAL,CAAYmI,UAAZ,CAAuBsB,cAAvB,MAA2C,KAAKzJ,MAAL,CAAYkF,YAAvD,IACA,KAAKlF,MAAL,CAAY6E,iBAAZ,CAA8BE,KAA9B,CAAoCC,SAApC,CAA8CC,MAA9C,GAAuD,CADvD,IAC4D,CAAC,KAAKjF,MAAL,CAAYoF,aAAZ,CAA0BC,eAD3F,EAC4G;AACxG,aAAKrF,MAAL,CAAYkF,YAAZ,CAAyBwE,oBAAzB;AACH;;AACD;AACH;;AACD,SAAKzB,QAAL,CAAc9I,aAAa,CAAC,KAAD,EAAQ;AAAEuH,MAAAA,SAAS,EAAE7G,GAAG,CAACqI;AAAjB,KAAR,CAA3B;AACA,QAAIyB,OAAO,GAAG,CAAC,KAAKvJ,SAAN,CAAd;AACAuJ,IAAAA,OAAO,CAAClE,IAAR,CAAagB,IAAb;;AACA,QAAI,KAAKzG,MAAL,CAAY6E,iBAAZ,CAA8BE,KAA9B,CAAoC6E,MAAxC,EAAgD;AAC5CD,MAAAA,OAAO,CAAClE,IAAR,CAAa,WAAb;AACH;;AACD,QAAI,KAAKzF,MAAL,CAAY6E,iBAAZ,CAA8BgF,qBAAlC,EAAyD;AACrDF,MAAAA,OAAO,CAAClE,IAAR,CAAa5F,GAAG,CAACiK,oBAAjB;AACH;;AACD,QAAI,KAAK9J,MAAL,CAAY+J,aAAZ,CAA0BC,gBAA9B,EAAgD;AAC5CL,MAAAA,OAAO,CAAClE,IAAR,CAAa5F,GAAG,CAACoK,iBAAjB;AACH;;AACD5K,IAAAA,QAAQ,CAAC,CAAC,KAAK4C,OAAN,CAAD,EAAiB0H,OAAjB,CAAR;AACA,SAAKO,WAAL,CAAiBzD,IAAjB;AACA,SAAKxE,OAAL,CAAakI,WAAb,CAAyB,KAAKC,iBAAL,CAAuBvK,GAAG,CAACwK,iBAA3B,CAAzB;AACA,SAAKpI,OAAL,CAAaC,aAAb,CAA2B,OAA3B,EAAoCoI,YAApC,CAAiD,MAAjD,EAAyD,cAAzD;AACA,SAAK7F,SAAL,GAAiB,KAAKD,oBAAL,EAAjB;AACA,SAAK+F,YAAL;AACA,SAAKC,aAAL;AACA,QAAI7I,MAAM,GAAI,KAAK3B,MAAL,CAAYqE,WAAZ,KAA4B,aAA7B,GAA8C,KAAKrE,MAAL,CAAYmI,UAAZ,CAAuBC,QAAvB,EAA9C,GAAkF,KAAKpI,MAAL,CAAYiC,OAA3G;;AACA,QAAI,KAAKjC,MAAL,CAAYoF,aAAZ,CAA0BC,eAA1B,IAA6C,CAAC1D,MAAM,CAACO,aAAP,CAAqB,MAAMrC,GAAG,CAACuJ,0BAA/B,CAAlD,EAA8G;AAC1G,WAAKC,0BAAL;AACH;;AACD,SAAKrJ,MAAL,CAAYoB,MAAZ,CAAmBxB,KAAK,CAAC0J,YAAzB,EAAuC,EAAvC;AACH,GAlCD;;AAmCAxJ,EAAAA,KAAK,CAAChB,SAAN,CAAgB6J,cAAhB,GAAiC,UAAU1G,OAAV,EAAmB;AAChDjD,IAAAA,YAAY,CAACiK,GAAb,CAAiBhH,OAAjB,EAA0B,WAA1B,EAAuC,KAAKjC,MAAL,CAAYyK,cAAZ,CAA2BC,aAAlE,EAAiF,KAAK1K,MAAL,CAAYyK,cAA7F;AACAzL,IAAAA,YAAY,CAACiK,GAAb,CAAiBhH,OAAjB,EAA0B,OAA1B,EAAmC,KAAKjC,MAAL,CAAYyK,cAAZ,CAA2B5J,SAA9D,EAAyE,KAAKb,MAAL,CAAYyK,cAArF;;AACA,QAAI,CAAC,KAAKzK,MAAL,CAAY6G,UAAjB,EAA6B;AACzB7H,MAAAA,YAAY,CAACiK,GAAb,CAAiBhH,OAAjB,EAA0B,UAA1B,EAAsC,KAAKjC,MAAL,CAAYyK,cAAZ,CAA2BE,YAAjE,EAA+E,KAAK3K,MAAL,CAAYyK,cAA3F;AACH;AACJ,GAND;;AAOA3K,EAAAA,KAAK,CAAChB,SAAN,CAAgByL,YAAhB,GAA+B,YAAY;AACvC,QAAIK,EAAE,GAAGzL,aAAa,CAAC,IAAD,CAAtB;AACA,SAAK0L,gBAAL,CAAsBD,EAAtB;AACA,QAAIE,MAAM,GAAG3L,aAAa,CAAC,IAAD,CAA1B;AACA2L,IAAAA,MAAM,CAACX,WAAP,CAAmB,KAAKY,iBAAL,EAAnB;AACAH,IAAAA,EAAE,CAACT,WAAH,CAAeW,MAAf;AACAtL,IAAAA,OAAO,CAAC,CAACoL,EAAD,CAAD,EAAO,KAAK3I,OAAL,CAAaC,aAAb,CAA2B,OAA3B,CAAP,CAAP;AACH,GAPD;;AAQApC,EAAAA,KAAK,CAAChB,SAAN,CAAgB+L,gBAAhB,GAAmC,UAAUD,EAAV,EAAc;AAC7C,QAAI,KAAK5K,MAAL,CAAY6E,iBAAZ,CAA8BmG,cAAlC,EAAkD;AAC9CJ,MAAAA,EAAE,CAACT,WAAH,CAAehL,aAAa,CAAC,IAAD,EAAO;AAAEuH,QAAAA,SAAS,EAAE;AAAb,OAAP,CAA5B;AACH;AACJ,GAJD;;AAKA5G,EAAAA,KAAK,CAAChB,SAAN,CAAgB0L,aAAhB,GAAgC,YAAY;AACxC,QAAII,EAAE,GAAGzL,aAAa,CAAC,IAAD,CAAtB;;AACA,QAAI,KAAKa,MAAL,CAAY6E,iBAAZ,CAA8BmG,cAAlC,EAAkD;AAC9CJ,MAAAA,EAAE,CAACT,WAAH,CAAe,KAAKc,uBAAL,EAAf;AACH;;AACD,QAAIC,MAAM,GAAG/L,aAAa,CAAC,IAAD,CAA1B;AACA,QAAI4J,IAAI,GAAG5J,aAAa,CAAC,KAAD,EAAQ;AAAEuH,MAAAA,SAAS,EAAE7G,GAAG,CAACmJ;AAAjB,KAAR,CAAxB;AACA,QAAImC,WAAW,GAAG,KAAKC,iBAAL,EAAlB;;AACA,QAAI,KAAKpL,MAAL,CAAYqE,WAAZ,KAA4B,OAAhC,EAAyC;AACrC0E,MAAAA,IAAI,CAACoB,WAAL,CAAiBgB,WAAjB;AACH,KAFD,MAGK;AACD,UAAIE,kBAAkB,GAAGlM,aAAa,CAAC,KAAD,EAAQ;AAAEuH,QAAAA,SAAS,EAAE7G,GAAG,CAACyL;AAAjB,OAAR,CAAtC;AACAD,MAAAA,kBAAkB,CAAClB,WAAnB,CAA+BgB,WAA/B;AACApC,MAAAA,IAAI,CAACoB,WAAL,CAAiBkB,kBAAjB;AACH;;AACDrM,IAAAA,YAAY,CAACiK,GAAb,CAAiBF,IAAjB,EAAuB,QAAvB,EAAiC,KAAKzH,eAAtC,EAAuD,IAAvD;AACA4J,IAAAA,MAAM,CAACf,WAAP,CAAmBpB,IAAnB;AACA6B,IAAAA,EAAE,CAACT,WAAH,CAAee,MAAf;AACA,SAAKjJ,OAAL,CAAaC,aAAb,CAA2B,OAA3B,EAAoCiI,WAApC,CAAgDS,EAAhD;AACA,SAAKzB,0BAAL;AACH,GArBD;;AAsBArJ,EAAAA,KAAK,CAAChB,SAAN,CAAgBmM,uBAAhB,GAA0C,YAAY;AAClD,QAAIM,OAAO,GAAG,KAAK3G,WAAL,CAAiBsB,GAAjB,CAAqB,UAAUC,IAAV,EAAgB;AAAE,aAAO,IAAIgB,IAAJ,CAAS,CAAChB,IAAV,CAAP;AAAyB,KAAhE,CAAd;AACA,QAAIqF,EAAE,GAAGrM,aAAa,CAAC,IAAD,CAAtB;AACA,QAAIsM,cAAc,GAAGtM,aAAa,CAAC,KAAD,EAAQ;AAAEuH,MAAAA,SAAS,EAAE7G,GAAG,CAACsC;AAAjB,KAAR,CAAlC;AACAqJ,IAAAA,EAAE,CAACrB,WAAH,CAAesB,cAAf;AACA,QAAIC,gBAAgB,GAAG,KAAKtB,iBAAL,EAAvB;AACAqB,IAAAA,cAAc,CAACtB,WAAf,CAA2BuB,gBAA3B;AACA,QAAIC,QAAQ,GAAG,KAAK3L,MAAL,CAAY6E,iBAAZ,CAA8Bc,WAA9B,GAA4ChG,IAAI,CAACiG,WAAjD,GACX,KAAK5F,MAAL,CAAY6E,iBAAZ,CAA8BC,QAA9B,CAAuCG,MAD3C;;AAEA,SAAK,IAAI2G,CAAC,GAAG,CAAR,EAAWC,QAAQ,GAAI,KAAKjH,WAAL,CAAiBK,MAAjB,GAA0B0G,QAAtD,EAAiEC,CAAC,GAAGC,QAArE,EAA+ED,CAAC,EAAhF,EAAoF;AAChF,UAAIE,KAAK,GAAGP,OAAO,CAACQ,MAAR,CAAe,CAAf,EAAkBJ,QAAlB,CAAZ;AACA,UAAIK,UAAU,GAAG,KAAKC,oBAAL,CAA0BH,KAA1B,EAAiCtE,QAAjC,EAAjB;AACAkE,MAAAA,gBAAgB,CAACxJ,aAAjB,CAA+B,OAA/B,EAAwCiI,WAAxC,CAAoD,KAAK+B,uBAAL,CAA6BF,UAA7B,CAApD;AACH;;AACD,WAAOR,EAAP;AACH,GAfD;;AAgBA1L,EAAAA,KAAK,CAAChB,SAAN,CAAgBqK,0BAAhB,GAA6C,YAAY,CACrD;AACH,GAFD;;AAGArJ,EAAAA,KAAK,CAAChB,SAAN,CAAgBiM,iBAAhB,GAAoC,YAAY;AAC5C,QAAIoB,SAAS,GAAGhN,aAAa,CAAC,KAAD,EAAQ;AAAEuH,MAAAA,SAAS,EAAE7G,GAAG,CAACuM;AAAjB,KAAR,CAA7B;AACA,QAAIrD,IAAI,GAAG5J,aAAa,CAAC,KAAD,EAAQ;AAAEuH,MAAAA,SAAS,EAAE7G,GAAG,CAACyI;AAAjB,KAAR,CAAxB;AACA6D,IAAAA,SAAS,CAAChC,WAAV,CAAsBpB,IAAtB;AACA,QAAIsD,KAAK,GAAG,KAAKjC,iBAAL,EAAZ;AACA,SAAKkC,cAAL,CAAoBD,KAApB,EAA2B,KAAK5H,SAAL,CAAe,KAAKA,SAAL,CAAeQ,MAAf,GAAwB,CAAvC,CAA3B;AACA,QAAIsH,KAAK,GAAGpN,aAAa,CAAC,IAAD,CAAzB;;AACA,SAAK,IAAIyM,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKnH,SAAL,CAAeQ,MAAnC,EAA2C2G,CAAC,EAA5C,EAAgD;AAC5C,UAAIlH,KAAK,GAAG,KAAKD,SAAL,CAAemH,CAAf,CAAZ;AACA,UAAIY,GAAG,GAAGD,KAAK,CAACE,SAAN,EAAV;;AACA,WAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGhI,KAAK,CAACO,MAA1B,EAAkCyH,CAAC,EAAnC,EAAuC;AACnC,YAAIlB,EAAE,GAAG9G,KAAK,CAACgI,CAAD,CAAd;AACAF,QAAAA,GAAG,CAACrC,WAAJ,CAAgB,KAAKwC,gBAAL,CAAsBnB,EAAtB,CAAhB;AACH;;AACDa,MAAAA,KAAK,CAACnK,aAAN,CAAoB,OAApB,EAA6BiI,WAA7B,CAAyCqC,GAAzC;AACH;;AACDzD,IAAAA,IAAI,CAACoB,WAAL,CAAiBkC,KAAjB;AACA,WAAOF,SAAP;AACH,GAlBD;;AAmBArM,EAAAA,KAAK,CAAChB,SAAN,CAAgB6N,gBAAhB,GAAmC,UAAUnB,EAAV,EAAc;AAC7C,QAAIoB,KAAK,GAAGzN,aAAa,CAAC,IAAD,CAAzB;AACA,SAAK0N,aAAL,CAAmBrB,EAAnB,EAAuBoB,KAAvB;;AACA,QAAIpB,EAAE,CAAC/E,IAAH,KAAY,UAAhB,EAA4B;AACxB,UAAIoB,GAAG,GAAG1I,aAAa,CAAC,MAAD,EAAS;AAAE2N,QAAAA,SAAS,EAAEnN,IAAI,CAACoN,mBAAL,CAAyB,KAAK/M,MAAL,CAAYgN,WAAZ,CAAwB,KAAK7M,aAA7B,EAA4CqL,EAAE,CAACrF,IAAH,CAAQC,MAAR,EAA5C,CAAzB,EAAwF,QAAxF;AAAb,OAAT,CAAvB;AACAwG,MAAAA,KAAK,CAACzC,WAAN,CAAkBtC,GAAlB;AACH;;AACD,QAAI2D,EAAE,CAAC/E,IAAH,KAAY,gBAAhB,EAAkC;AAC9B,WAAKwG,wBAAL,CAA8BL,KAA9B,EAAqCpB,EAArC;AACH;;AACD,QAAIA,EAAE,CAAC/E,IAAH,KAAY,YAAhB,EAA8B;AAC1BpH,MAAAA,QAAQ,CAAC,CAACuN,KAAD,CAAD,EAAU/M,GAAG,CAACqN,iBAAd,CAAR;AACAN,MAAAA,KAAK,CAACtC,YAAN,CAAmB,WAAnB,EAAgCkB,EAAE,CAACrF,IAAH,CAAQoB,OAAR,GAAkBC,QAAlB,EAAhC;;AACA,UAAI,KAAKxH,MAAL,CAAY6E,iBAAZ,CAA8BsI,kBAAlC,EAAsD;AAClD,YAAIC,SAAS,GAAGzN,IAAI,CAACuH,cAAL,CAAoBsE,EAAE,CAACrF,IAAvB,CAAhB;AACA,YAAIkH,QAAQ,GAAG;AAAElH,UAAAA,IAAI,EAAEiH,SAAR;AAAmB3G,UAAAA,IAAI,EAAE+E,EAAE,CAAC/E;AAA5B,SAAf;AACA,YAAI6G,SAAS,GAAG,KAAKtN,MAAL,CAAYiC,OAAZ,CAAoBsL,EAApB,GAAyB,GAAzC;AACA,YAAIC,QAAQ,GAAG,KAAKxN,MAAL,CAAY6E,iBAAZ,CAA8B4I,sBAA7C;AACA,YAAIC,UAAU,GAAGJ,SAAS,GAAGE,QAAZ,GAAuB,oBAAxC;AACA,YAAIG,YAAY,GAAG,GAAG1H,KAAH,CAAS/F,IAAT,CAAc,KAAKF,MAAL,CAAY4N,qBAAZ,GAAoCP,QAApC,EAA8C,KAAKrN,MAAnD,EAA2D,oBAA3D,EAAiF0N,UAAjF,EAA6F,KAA7F,CAAd,CAAnB;;AACA,YAAIC,YAAY,IAAIA,YAAY,CAAC1I,MAAjC,EAAyC;AACrC1F,UAAAA,MAAM,CAACoO,YAAD,EAAef,KAAf,CAAN;AACH;AACJ,OAVD,MAWK;AACD,YAAI/E,GAAG,GAAG1I,aAAa,CAAC,MAAD,EAAS;AAAEuH,UAAAA,SAAS,EAAE7G,GAAG,CAACgO;AAAjB,SAAT,CAAvB;AACA,YAAIC,QAAQ,GAAG,MAAf;AACA,YAAIC,KAAK,GAAG,KAAK/N,MAAL,CAAYgO,SAAZ,CAAsBC,UAAtB,CAAiCzC,EAAE,CAACrF,IAApC,EAA0C;AAAE2H,UAAAA,QAAQ,EAAEA,QAAZ;AAAsBI,UAAAA,QAAQ,EAAE,KAAKlO,MAAL,CAAYmO,eAAZ;AAAhC,SAA1C,CAAZ;AACAtG,QAAAA,GAAG,CAACyC,YAAJ,CAAiB,OAAjB,EAA0B3K,IAAI,CAACoN,mBAAL,CAAyBgB,KAAzB,EAAgC,UAAhC,CAA1B;AACA,YAAIK,SAAS,GAAI,KAAKpO,MAAL,CAAYqO,YAAZ,CAAyBC,YAAzB,CAAsC9C,EAAE,CAACrF,IAAzC,KAAkD,CAAC,KAAKoI,aAAL,CAAmB/C,EAAE,CAACrF,IAAtB,CAAnD,IAAkF,CAAC,KAAKnG,MAAL,CAAY6G,UAAhG,GACZ,KAAK7G,MAAL,CAAYgO,SAAZ,CAAsBC,UAAtB,CAAiCzC,EAAE,CAACrF,IAApC,EAA0C;AAAEqI,UAAAA,MAAM,EAAE,OAAV;AAAmBN,UAAAA,QAAQ,EAAE,KAAKlO,MAAL,CAAYmO,eAAZ;AAA7B,SAA1C,CADY,GAEZ,KAAKnO,MAAL,CAAYgO,SAAZ,CAAsBC,UAAtB,CAAiCzC,EAAE,CAACrF,IAApC,EAA0C;AAAE2H,UAAAA,QAAQ,EAAE,GAAZ;AAAiBI,UAAAA,QAAQ,EAAE,KAAKlO,MAAL,CAAYmO,eAAZ;AAA3B,SAA1C,CAFJ;AAGAtG,QAAAA,GAAG,CAACiF,SAAJ,GAAgBnN,IAAI,CAACoN,mBAAL,CAAyBqB,SAAzB,EAAoC,QAApC,CAAhB;AACAxB,QAAAA,KAAK,CAACzC,WAAN,CAAkBtC,GAAlB;AACH;;AACD,WAAKc,cAAL,CAAoBiE,KAApB;AACH;;AACD,QAAI3L,IAAI,GAAG;AAAEwN,MAAAA,WAAW,EAAEjD,EAAE,CAAC/E,IAAlB;AAAwBxE,MAAAA,OAAO,EAAE2K,KAAjC;AAAwCzG,MAAAA,IAAI,EAAEqF,EAAE,CAACrF,IAAjD;AAAuDX,MAAAA,UAAU,EAAEgG,EAAE,CAAChG;AAAtE,KAAX;AACA,SAAKxF,MAAL,CAAY0O,OAAZ,CAAoB9O,KAAK,CAAC+O,UAA1B,EAAsC1N,IAAtC;AACA,WAAO2L,KAAP;AACH,GAxCD;;AAyCA9M,EAAAA,KAAK,CAAChB,SAAN,CAAgB8P,eAAhB,GAAkC,YAAY;AAC1C,QAAI,EAAE,KAAKnK,SAAL,CAAe,KAAKA,SAAL,CAAeQ,MAAf,GAAwB,CAAvC,KAA6C,KAAKR,SAAL,CAAe,KAAKA,SAAL,CAAeQ,MAAf,GAAwB,CAAvC,EAA0C,CAA1C,CAA/C,CAAJ,EAAkG;AAC9F,aAAO,EAAP;AACH;;AACD,QAAI4J,SAAS,GAAG,EAAhB;;AACA,QAAIC,YAAY,GAAG,UAAUC,QAAV,EAAoBC,UAApB,EAAgCC,OAAhC,EAAyClJ,SAAzC,EAAoD;AACnE,UAAImJ,IAAI,GAAG;AACP/I,QAAAA,IAAI,EAAE,IAAIgB,IAAJ,CAAS,CAAC6H,UAAV,CADC;AACsBxJ,QAAAA,UAAU,EAAEyJ,OAAO,CAACzJ,UAD1C;AACsDV,QAAAA,QAAQ,EAAEmK,OAAO,CAACnK,QADxE;AAEP2B,QAAAA,IAAI,EAAE,YAFC;AAEaC,QAAAA,SAAS,EAAEX,SAAS,IAAI,CAAClG,GAAG,CAACyH,gBAAL;AAFrC,OAAX;;AAIA,UAAI,CAACuH,SAAS,CAACE,QAAD,CAAd,EAA0B;AACtBF,QAAAA,SAAS,CAACE,QAAD,CAAT,GAAsB,EAAtB;AACH;;AACDF,MAAAA,SAAS,CAACE,QAAD,CAAT,CAAoBtJ,IAApB,CAAyByJ,IAAzB;AACH,KATD;;AAUA,QAAIC,eAAe,GAAG,KAAKnP,MAAL,CAAYqE,WAAZ,KAA4B,aAA5B,IAClB,KAAKrE,MAAL,CAAY6E,iBAAZ,CAA8BE,KAA9B,CAAoCC,SAApC,CAA8CC,MAA9C,GAAuD,CAD3D;;AAEA,QAAIkK,eAAe,IAAI,CAAC,KAAKnP,MAAL,CAAYoF,aAAZ,CAA0BC,eAA9C,IAAiE,CAAC,KAAKrF,MAAL,CAAY6E,iBAAZ,CAA8BE,KAA9B,CAAoC6E,MAA1G,EAAkH;AAC9G,WAAK,IAAIjC,EAAE,GAAG,CAAT,EAAYY,EAAE,GAAG,KAAK9D,SAAL,CAAe,KAAKA,SAAL,CAAeQ,MAAf,GAAwB,CAAvC,CAAtB,EAAiE0C,EAAE,GAAGY,EAAE,CAACtD,MAAzE,EAAiF0C,EAAE,EAAnF,EAAuF;AACnF,YAAIyH,GAAG,GAAG7G,EAAE,CAACZ,EAAD,CAAZ;AACA,YAAImE,KAAK,GAAGsD,GAAG,CAACxK,WAAJ,CAAgBsB,GAAhB,CAAoB,UAAUC,IAAV,EAAgB;AAAE,iBAAO,IAAIgB,IAAJ,CAAS,CAAChB,IAAV,CAAP;AAAyB,SAA/D,CAAZ;AACA,YAAIT,KAAK,GAAG,KAAK1F,MAAL,CAAY6E,iBAAZ,CAA8Bc,WAA9B,GAA4ChG,IAAI,CAACiG,WAAjD,GAA+DwJ,GAAG,CAACtK,QAAJ,CAAaG,MAAxF;;AACA,aAAK,IAAI2G,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAIwD,GAAG,CAACxK,WAAJ,CAAgBK,MAAhB,GAAyBS,KAA9C,EAAsDkG,CAAC,EAAvD,EAA2D;AACvD,cAAIyD,QAAQ,GAAGvD,KAAK,CAACC,MAAN,CAAa,CAAb,EAAgBrG,KAAhB,CAAf;;AACA,eAAK,IAAI4J,EAAE,GAAG,CAAT,EAAYC,UAAU,GAAGF,QAA9B,EAAwCC,EAAE,GAAGC,UAAU,CAACtK,MAAxD,EAAgEqK,EAAE,EAAlE,EAAsE;AAClE,gBAAIE,OAAO,GAAGD,UAAU,CAACD,EAAD,CAAxB;AACAR,YAAAA,YAAY,CAAClD,CAAD,EAAI4D,OAAJ,EAAaJ,GAAb,CAAZ;AACH;AACJ;AACJ;AACJ,KAbD,MAcK;AACD,UAAItD,KAAK,GAAG,KAAKlH,WAAL,CAAiBsB,GAAjB,CAAqB,UAAUC,IAAV,EAAgB;AAAE,eAAO,IAAIgB,IAAJ,CAAS,CAAChB,IAAV,CAAP;AAAyB,OAAhE,CAAZ;AACA,UAAIT,KAAK,GAAG,KAAK1F,MAAL,CAAY6E,iBAAZ,CAA8Bc,WAA9B,GAA4ChG,IAAI,CAACiG,WAAjD,GACR,KAAK5F,MAAL,CAAY6E,iBAAZ,CAA8BC,QAA9B,CAAuCG,MAD3C;;AAEA,WAAK,IAAI2G,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAI,KAAKhH,WAAL,CAAiBK,MAAjB,GAA0BS,KAA/C,EAAuDkG,CAAC,EAAxD,EAA4D;AACxD,YAAIyD,QAAQ,GAAGvD,KAAK,CAACC,MAAN,CAAa,CAAb,EAAgBrG,KAAhB,CAAf;;AACA,aAAK,IAAI+J,EAAE,GAAG,CAAT,EAAYC,UAAU,GAAGL,QAA9B,EAAwCI,EAAE,GAAGC,UAAU,CAACzK,MAAxD,EAAgEwK,EAAE,EAAlE,EAAsE;AAClE,cAAID,OAAO,GAAGE,UAAU,CAACD,EAAD,CAAxB;;AACA,cAAIN,eAAJ,EAAqB;AACjB,gBAAIQ,OAAO,GAAG,KAAKlL,SAAL,CAAgB,KAAKA,SAAL,CAAeQ,MAAf,GAAwB,CAAxC,CAAd;AACA,gBAAI2K,WAAW,GAAGD,OAAO,CAAC1J,KAAR,CAAc,CAAd,EAAiB0J,OAAO,CAAC1K,MAAR,GAAiBS,KAAlC,CAAlB;;AACA,iBAAK,IAAImK,QAAQ,GAAG,CAApB,EAAuBA,QAAQ,GAAGD,WAAW,CAAC3K,MAA9C,EAAsD4K,QAAQ,EAA9D,EAAkE;AAC9D,kBAAIlG,OAAO,GAAG,KAAK,CAAnB;;AACA,kBAAIkG,QAAQ,KAAK,CAAjB,EAAoB;AAChBlG,gBAAAA,OAAO,GAAG,CAAC9J,GAAG,CAACyH,gBAAL,EAAuBzH,GAAG,CAACiQ,YAA3B,CAAV;AACH;;AACDhB,cAAAA,YAAY,CAAClD,CAAD,EAAI4D,OAAJ,EAAaI,WAAW,CAACC,QAAD,CAAxB,EAAoClG,OAApC,CAAZ;AACH;AACJ,WAVD,MAWK;AACDmF,YAAAA,YAAY,CAAClD,CAAD,EAAI4D,OAAJ,EAAa,KAAK/K,SAAL,CAAe,KAAKA,SAAL,CAAeQ,MAAf,GAAwB,CAAvC,EAA0C,CAA1C,CAAb,CAAZ;AACH;AACJ;AACJ;AACJ;;AACD,WAAO4J,SAAP;AACH,GAzDD;;AA0DA/O,EAAAA,KAAK,CAAChB,SAAN,CAAgBiR,eAAhB,GAAkC,UAAUb,IAAV,EAAgB;AAC9C,QAAI,KAAKc,YAAL,CAAkBd,IAAI,CAAC/I,IAAvB,CAAJ,EAAkC;AAC9B+I,MAAAA,IAAI,CAACxI,SAAL,CAAejB,IAAf,CAAoB5F,GAAG,CAACoQ,gBAAxB;AACH;;AACD,QAAI,CAAC,KAAKjQ,MAAL,CAAYkQ,YAAZ,CAAyBhB,IAAI,CAAC/I,IAA9B,CAAL,EAA0C;AACtC+I,MAAAA,IAAI,CAACxI,SAAL,CAAejB,IAAf,CAAoB5F,GAAG,CAACsQ,aAAxB;AACH;;AACD,QAAI,KAAKnQ,MAAL,CAAYqE,WAAZ,KAA4B,aAA5B,IAA6C,KAAKrE,MAAL,CAAYoQ,cAAZ,CAA2BlB,IAAI,CAAC/I,IAAhC,CAAjD,EAAwF;AACpF+I,MAAAA,IAAI,CAACxI,SAAL,CAAejB,IAAf,CAAoB5F,GAAG,CAACwQ,mBAAxB;AACH;AACJ,GAVD;;AAWAvQ,EAAAA,KAAK,CAAChB,SAAN,CAAgBkR,YAAhB,GAA+B,UAAU7J,IAAV,EAAgB;AAC3C,WAAOA,IAAI,CAACoB,OAAL,KAAiB,KAAKjH,UAAL,CAAgBgQ,KAAhB,CAAsB/I,OAAtB,EAAjB,IAAoDpB,IAAI,CAACoB,OAAL,KAAiB,KAAKjH,UAAL,CAAgBiQ,GAAhB,CAAoBhJ,OAApB,EAA5E;AACH,GAFD;;AAGAzH,EAAAA,KAAK,CAAChB,SAAN,CAAgBsM,iBAAhB,GAAoC,YAAY;AAC5C,QAAIoF,GAAG,GAAG,KAAKpG,iBAAL,CAAuBvK,GAAG,CAACyE,mBAA3B,CAAV;AACA,SAAKmM,kBAAL,CAAwBD,GAAxB;;AACA,QAAI,KAAKxQ,MAAL,CAAYqE,WAAZ,KAA4B,eAAhC,EAAiD;AAC7C,WAAKiI,cAAL,CAAoBkE,GAApB,EAAyB,KAAK/L,SAAL,CAAe,KAAKA,SAAL,CAAeQ,MAAf,GAAwB,CAAvC,CAAzB;AACH;;AACD,QAAIyL,SAAS,GAAG,IAAIvJ,IAAJ,CAAS,KAAKnH,MAAL,CAAYiE,YAAZ,CAAyBsD,OAAzB,EAAT,CAAhB;AACA,SAAKjH,UAAL,GAAkB;AACdgQ,MAAAA,KAAK,EAAE,KAAKtQ,MAAL,CAAYqO,YAAZ,CAAyBsC,gBAAzB,CAA0CD,SAA1C,CADO;AAEdH,MAAAA,GAAG,EAAE,KAAKvQ,MAAL,CAAYqO,YAAZ,CAAyBuC,eAAzB,CAAyCjR,IAAI,CAACkR,SAAL,CAAeH,SAAf,EAA0B,KAAK1Q,MAAL,CAAY6E,iBAAZ,CAA8BiM,QAA9B,GAAyC,CAAnE,CAAzC;AAFS,KAAlB;AAIA,QAAIC,KAAK,GAAGP,GAAG,CAACtO,aAAJ,CAAkB,OAAlB,CAAZ;AACA3C,IAAAA,MAAM,CAAC,KAAKyR,cAAL,EAAD,EAAwBD,KAAxB,CAAN;AACA,SAAKpI,cAAL,CAAoBoI,KAApB;AACA,WAAOP,GAAP;AACH,GAfD;;AAgBA1Q,EAAAA,KAAK,CAAChB,SAAN,CAAgBkS,cAAhB,GAAiC,YAAY;AACzC,QAAIC,KAAK,GAAG,EAAZ;AACA,QAAIrG,EAAE,GAAGzL,aAAa,CAAC,IAAD,EAAO;AAAE+R,MAAAA,KAAK,EAAE;AAAEC,QAAAA,IAAI,EAAE;AAAR;AAAT,KAAP,CAAtB;AACA,QAAI3F,EAAE,GAAGrM,aAAa,CAAC,IAAD,EAAO;AAAE+R,MAAAA,KAAK,EAAE;AAAEC,QAAAA,IAAI,EAAE,UAAR;AAAoB,yBAAiB;AAArC;AAAT,KAAP,CAAtB;AACA,QAAItC,SAAS,GAAG,KAAKD,eAAL,EAAhB;;AACA,SAAK,IAAIwC,GAAG,GAAG,CAAf,EAAkBA,GAAG,GAAGvC,SAAS,CAAC5J,MAAlC,EAA0CmM,GAAG,EAA7C,EAAiD;AAC7C,UAAI5E,GAAG,GAAG5B,EAAE,CAAC6B,SAAH,EAAV;;AACA,WAAK,IAAI3G,GAAG,GAAG,CAAf,EAAkBA,GAAG,GAAG+I,SAAS,CAACuC,GAAD,CAAT,CAAenM,MAAvC,EAA+Ca,GAAG,EAAlD,EAAsD;AAClD,YAAIuL,GAAG,GAAG,KAAKC,eAAL,CAAqBzC,SAAS,CAACuC,GAAD,CAAT,CAAetL,GAAf,CAArB,EAA0C0F,EAA1C,CAAV;AACAgB,QAAAA,GAAG,CAACrC,WAAJ,CAAgBkH,GAAhB;AACH;;AACDJ,MAAAA,KAAK,CAACxL,IAAN,CAAW+G,GAAX;AACH;;AACD,WAAOyE,KAAP;AACH,GAdD;;AAeAnR,EAAAA,KAAK,CAAChB,SAAN,CAAgBwS,eAAhB,GAAkC,UAAUpC,IAAV,EAAgB1D,EAAhB,EAAoB;AAClD,QAAI6F,GAAG,GAAG7F,EAAE,CAACiB,SAAH,EAAV;;AACA,QAAIyC,IAAI,CAACvI,OAAT,EAAkB;AACd0K,MAAAA,GAAG,CAAC/G,YAAJ,CAAiB,SAAjB,EAA4B4E,IAAI,CAACvI,OAAL,CAAaa,QAAb,EAA5B;AACH;;AACD,SAAKuI,eAAL,CAAqBb,IAArB;AACA,QAAIzI,IAAI,GAAGyI,IAAI,CAACzI,IAAhB;;AACA,QAAIyI,IAAI,CAACxI,SAAL,CAAeJ,OAAf,CAAuBzG,GAAG,CAAC0R,qBAA3B,MAAsD,CAAC,CAA3D,EAA8D;AAC1DrC,MAAAA,IAAI,CAACxI,SAAL,CAAejB,IAAf,CAAoB5F,GAAG,CAAC2R,0BAAxB;AACA/K,MAAAA,IAAI,GAAG,oBAAP;AACH;;AACD,QAAI,KAAKzG,MAAL,CAAYyR,SAAZ,CAAsBC,SAAtB,IAAmC,KAAKC,SAAL,CAAezC,IAAI,CAAC/I,IAApB,EAA0B+I,IAAI,CAACpK,QAA/B,CAAvC,EAAiF;AAC7EoK,MAAAA,IAAI,CAACxI,SAAL,CAAejB,IAAf,CAAoB5F,GAAG,CAAC+R,aAAxB;AACH;;AACD,QAAI,KAAKrD,aAAL,CAAmBW,IAAI,CAAC/I,IAAxB,CAAJ,EAAmC;AAC/B+I,MAAAA,IAAI,CAACxI,SAAL,CAAejB,IAAf,CAAoB5F,GAAG,CAAC4H,iBAAxB;AACH;;AACDpI,IAAAA,QAAQ,CAAC,CAACgS,GAAD,CAAD,EAAQnC,IAAI,CAACxI,SAAb,CAAR;AACA2K,IAAAA,GAAG,CAAC/G,YAAJ,CAAiB,WAAjB,EAA8B4E,IAAI,CAAC/I,IAAL,CAAUoB,OAAV,GAAoBC,QAApB,EAA9B;;AACA,QAAI,CAACtI,iBAAiB,CAACgQ,IAAI,CAAC1J,UAAN,CAAlB,IAAuC,KAAKxF,MAAL,CAAYoF,aAAZ,CAA0BC,eAArE,EAAsF;AAClF,UAAIG,UAAU,GAAG,KAAKxF,MAAL,CAAYoF,aAAZ,CAA0BC,eAA1B,GAA4C,KAAKrF,MAAL,CAAYoF,aAAZ,CAA0BI,UAAtE,GACb0J,IAAI,CAAC1J,UADT;AAEA6L,MAAAA,GAAG,CAAC/G,YAAJ,CAAiB,kBAAjB,EAAqC,KAAK9E,UAA1C;AACH;;AACD,SAAKqM,uBAAL,CAA6B3C,IAA7B,EAAmCmC,GAAnC;;AACA,QAAI,KAAKrR,MAAL,CAAY6E,iBAAZ,CAA8BiN,YAAlC,EAAgD;AAC5C,UAAI1E,SAAS,GAAGzN,IAAI,CAACuH,cAAL,CAAoBgI,IAAI,CAAC/I,IAAzB,CAAhB;AACA,UAAI4L,MAAM,GAAG;AAAE5L,QAAAA,IAAI,EAAEiH,SAAR;AAAmB3G,QAAAA,IAAI,EAAEA,IAAzB;AAA+BjB,QAAAA,UAAU,EAAE0J,IAAI,CAAC1J;AAAhD,OAAb;AACA,UAAIwM,UAAU,GAAG,KAAKhS,MAAL,CAAYiC,OAAZ,CAAoBsL,EAApB,GAAyB,GAA1C;AACA,UAAIC,QAAQ,GAAG,KAAKxN,MAAL,CAAY6E,iBAAZ,CAA8BoN,gBAA7C;AACA,UAAIvE,UAAU,GAAGsE,UAAU,GAAGxE,QAAb,GAAwB,cAAzC;AACA,UAAIsE,YAAY,GAAG,GAAG7L,KAAH,CAAS/F,IAAT,CAAc,KAAKF,MAAL,CAAYkS,eAAZ,GAA8BH,MAA9B,EAAsC,KAAK/R,MAA3C,EAAmD,cAAnD,EAAmE0N,UAAnE,EAA+E,KAA/E,CAAd,CAAnB;AACAnO,MAAAA,MAAM,CAACuS,YAAD,EAAeT,GAAf,CAAN;AACH;;AACD,QAAIpQ,IAAI,GAAG;AAAEwN,MAAAA,WAAW,EAAEhI,IAAf;AAAqBxE,MAAAA,OAAO,EAAEoP,GAA9B;AAAmClL,MAAAA,IAAI,EAAE+I,IAAI,CAAC/I,IAA9C;AAAoDX,MAAAA,UAAU,EAAE0J,IAAI,CAAC1J;AAArE,KAAX;AACA,SAAKxF,MAAL,CAAY0O,OAAZ,CAAoB9O,KAAK,CAAC+O,UAA1B,EAAsC1N,IAAtC;AACA,WAAOoQ,GAAP;AACH,GArCD;;AAsCAvR,EAAAA,KAAK,CAAChB,SAAN,CAAgB+S,uBAAhB,GAA0C,UAAU3C,IAAV,EAAgBmC,GAAhB,EAAqB;AAC3D,QAAI,KAAKrR,MAAL,CAAYqE,WAAZ,KAA4B,eAAhC,EAAiD;AAC7C;AACH;;AACD,QAAI8N,UAAU,GAAGhT,aAAa,CAAC,KAAD,EAAQ;AAAEuH,MAAAA,SAAS,EAAE7G,GAAG,CAACqN;AAAjB,KAAR,CAA9B;;AACA,QAAI,KAAKlN,MAAL,CAAY6E,iBAAZ,CAA8BuN,kBAAlC,EAAsD;AAClD,UAAIhF,SAAS,GAAGzN,IAAI,CAACuH,cAAL,CAAoBgI,IAAI,CAAC/I,IAAzB,CAAhB;AACA,UAAIlF,IAAI,GAAG;AAAEkF,QAAAA,IAAI,EAAEiH,SAAR;AAAmB3G,QAAAA,IAAI,EAAEyI,IAAI,CAACzI,IAA9B;AAAoCjB,QAAAA,UAAU,EAAE0J,IAAI,CAAC1J;AAArD,OAAX;AACA,UAAIwM,UAAU,GAAG,KAAKhS,MAAL,CAAYiC,OAAZ,CAAoBsL,EAApB,GAAyB,GAA1C;AACA,UAAIC,QAAQ,GAAG,KAAKxN,MAAL,CAAY6E,iBAAZ,CAA8BwN,sBAA7C;AACA,UAAI3E,UAAU,GAAGsE,UAAU,GAAGxE,QAAb,GAAwB,oBAAzC;AACA,UAAI8E,kBAAkB,GAAG,GAAGrM,KAAH,CAAS/F,IAAT,CAAc,KAAKF,MAAL,CAAYuS,qBAAZ,GAAoCtR,IAApC,EAA0C,KAAKjB,MAA/C,EAAuD,oBAAvD,EAA6E0N,UAA7E,EAAyF,KAAzF,CAAd,CAAzB;AACAnO,MAAAA,MAAM,CAAC+S,kBAAD,EAAqBH,UAArB,CAAN;AACH,KARD,MASK;AACD,UAAI/D,SAAS,GAAI,KAAKpO,MAAL,CAAYqO,YAAZ,CAAyBC,YAAzB,CAAsCY,IAAI,CAAC/I,IAA3C,KAAoD,CAAC,KAAKoI,aAAL,CAAmBW,IAAI,CAAC/I,IAAxB,CAArD,IAAsF,CAAC,KAAKnG,MAAL,CAAY6G,UAApG,GACZ,KAAK7G,MAAL,CAAYgO,SAAZ,CAAsBC,UAAtB,CAAiCiB,IAAI,CAAC/I,IAAtC,EAA4C;AAAEqI,QAAAA,MAAM,EAAE,OAAV;AAAmBN,QAAAA,QAAQ,EAAE,KAAKlO,MAAL,CAAYmO,eAAZ;AAA7B,OAA5C,CADY,GAEZ,KAAKnO,MAAL,CAAYgO,SAAZ,CAAsBC,UAAtB,CAAiCiB,IAAI,CAAC/I,IAAtC,EAA4C;AAAE2H,QAAAA,QAAQ,EAAE,GAAZ;AAAiBI,QAAAA,QAAQ,EAAE,KAAKlO,MAAL,CAAYmO,eAAZ;AAA3B,OAA5C,CAFJ;AAGAgE,MAAAA,UAAU,CAACrF,SAAX,GAAuBnN,IAAI,CAACoN,mBAAL,CAAyBqB,SAAzB,EAAoC,QAApC,CAAvB;AACH;;AACDiD,IAAAA,GAAG,CAAClH,WAAJ,CAAgBgI,UAAhB;;AACA,QAAI,KAAKK,aAAL,OAAyB,OAA7B,EAAsC;AAClCnT,MAAAA,QAAQ,CAAC,CAAC8S,UAAD,CAAD,EAAetS,GAAG,CAACgO,cAAnB,CAAR;AACA,UAAIC,QAAQ,GAAG,MAAf;AACA,UAAI2E,cAAc,GAAG,KAAKzS,MAAL,CAAYgO,SAAZ,CAAsBC,UAAtB,CAAiCiB,IAAI,CAAC/I,IAAtC,EAA4C;AAAE2H,QAAAA,QAAQ,EAAEA,QAAZ;AAAsBI,QAAAA,QAAQ,EAAE,KAAKlO,MAAL,CAAYmO,eAAZ;AAAhC,OAA5C,CAArB;AACAgE,MAAAA,UAAU,CAAC7H,YAAX,CAAwB,YAAxB,EAAsCmI,cAAtC;AACH;AACJ,GA3BD;;AA4BA3S,EAAAA,KAAK,CAAChB,SAAN,CAAgB4T,aAAhB,GAAgC,UAAUC,WAAV,EAAuB;AACnD,QAAIC,UAAU,GAAGjT,IAAI,CAACkT,gBAAL,CAAsB,KAAK7S,MAAL,CAAYqO,YAAZ,CAAyBsC,gBAAzB,CAA0CgC,WAA1C,CAAtB,EAA8E,KAAK3S,MAAL,CAAY6E,iBAAZ,CAA8BiO,cAA5G,CAAjB;AACA,QAAIxC,KAAK,GAAG,IAAInJ,IAAJ,CAASyL,UAAU,CAACG,WAAX,EAAT,EAAmCH,UAAU,CAACI,QAAX,EAAnC,EAA0DJ,UAAU,CAACK,OAAX,EAA1D,CAAZ;AACA,WAAO3C,KAAP;AACH,GAJD;;AAKAxQ,EAAAA,KAAK,CAAChB,SAAN,CAAgBoU,WAAhB,GAA8B,UAAUP,WAAV,EAAuB;AACjD,QAAIQ,OAAO,GAAGxT,IAAI,CAACkR,SAAL,CAAe8B,WAAf,EAA4B,KAAK3S,MAAL,CAAY6E,iBAAZ,CAA8BiM,QAA9B,GAAyC,CAArE,CAAd;AACA,QAAIsC,eAAe,GAAGzT,IAAI,CAACkT,gBAAL,CAAsB,KAAK7S,MAAL,CAAYqO,YAAZ,CAAyBuC,eAAzB,CAAyCuC,OAAzC,CAAtB,EAAyE,KAAKnT,MAAL,CAAY6E,iBAAZ,CAA8BiO,cAAvG,CAAtB;AACA,QAAIO,QAAQ,GAAG1T,IAAI,CAAC2T,OAAL,CAAaF,eAAb,EAA8BzT,IAAI,CAACiG,WAAL,GAAmB,CAAjD,CAAf;AACA,WAAOyN,QAAP;AACH,GALD;;AAMAvT,EAAAA,KAAK,CAAChB,SAAN,CAAgByU,cAAhB,GAAiC,UAAUzO,QAAV,EAAoB;AACjD,QAAIF,WAAW,GAAG,EAAlB;AACA,QAAI+N,WAAW,GAAGhT,IAAI,CAAC6T,SAAL,CAAe,KAAKxT,MAAL,CAAYiE,YAA3B,CAAlB;AACA,QAAIqM,KAAK,GAAG,KAAKoC,aAAL,CAAmBC,WAAnB,CAAZ;AACA,QAAIU,QAAQ,GAAG,KAAKH,WAAL,CAAiBP,WAAjB,CAAf;;AACA,OAAG;AACC,UAAI,KAAK3S,MAAL,CAAY6E,iBAAZ,CAA8Bc,WAAlC,EAA+C;AAC3Cf,QAAAA,WAAW,CAACa,IAAZ,CAAiB6K,KAAjB;AACH,OAFD,MAGK;AACD,YAAI,KAAKqB,SAAL,CAAerB,KAAf,EAAsBxL,QAAtB,CAAJ,EAAqC;AACjCF,UAAAA,WAAW,CAACa,IAAZ,CAAiB6K,KAAjB;AACH;AACJ;;AACDA,MAAAA,KAAK,GAAG3Q,IAAI,CAAC2T,OAAL,CAAahD,KAAb,EAAoB,CAApB,CAAR;;AACA,UAAIA,KAAK,CAACmD,QAAN,KAAmB,CAAvB,EAA0B;AACtBnD,QAAAA,KAAK,GAAG3Q,IAAI,CAAC6T,SAAL,CAAelD,KAAf,CAAR;AACH;AACJ,KAbD,QAaSA,KAAK,CAAC/I,OAAN,MAAmB8L,QAAQ,CAAC9L,OAAT,EAb5B;;AAcA,QAAI,CAACzC,QAAL,EAAe;AACX,WAAKF,WAAL,GAAmBA,WAAnB;AACH;;AACD,QAAI,KAAK5E,MAAL,CAAY0T,YAAhB,EAA8B;AAC1B,WAAK1T,MAAL,CAAY0T,YAAZ,CAAyBC,uBAAzB;AACH;;AACD,WAAO/O,WAAP;AACH,GA1BD;;AA2BA9E,EAAAA,KAAK,CAAChB,SAAN,CAAgB8U,mBAAhB,GAAsC,UAAUnN,IAAV,EAAgB;AAClD,QAAIA,IAAI,KAAK,MAAb,EAAqB;AACjB,aAAO9G,IAAI,CAACkR,SAAL,CAAe,KAAK7Q,MAAL,CAAYiE,YAA3B,EAAyC,KAAKjE,MAAL,CAAY6E,iBAAZ,CAA8BiM,QAAvE,CAAP;AACH,KAFD,MAGK;AACD,aAAOnR,IAAI,CAACkR,SAAL,CAAe,KAAK7Q,MAAL,CAAYiE,YAA3B,EAAyC,CAAE,KAAKjE,MAAL,CAAY6E,iBAAZ,CAA8BiM,QAAzE,CAAP;AACH;AACJ,GAPD;;AAQAhR,EAAAA,KAAK,CAAChB,SAAN,CAAgB+U,uBAAhB,GAA0C,UAAUvD,KAAV,EAAiB;AACvD,WAAO3Q,IAAI,CAAC2T,OAAL,CAAa,IAAInM,IAAJ,CAASmJ,KAAK,CAAC/I,OAAN,EAAT,CAAb,EAAwC,CAAxC,CAAP;AACH,GAFD;;AAGAzH,EAAAA,KAAK,CAAChB,SAAN,CAAgBgV,gBAAhB,GAAmC,YAAY;AAC3C,QAAI,KAAK9T,MAAL,CAAY6G,UAAZ,IAA0B3H,iBAAiB,CAAC,KAAKc,MAAL,CAAY6E,iBAAZ,CAA8BkP,UAA/B,CAA/C,EAA2F;AACvF,UAAI,KAAK/T,MAAL,CAAY6E,iBAAZ,CAA8BiM,QAA9B,GAAyC,CAA7C,EAAgD;AAC5C,YAAIqC,OAAO,GAAGxT,IAAI,CAACkR,SAAL,CAAelR,IAAI,CAACiR,eAAL,CAAqB,KAAK5Q,MAAL,CAAYiE,YAAjC,CAAf,EAA+D,KAAKjE,MAAL,CAAY6E,iBAAZ,CAA8BiM,QAA9B,GAAyC,CAAxG,CAAd;;AACA,YAAI,KAAK9Q,MAAL,CAAYiE,YAAZ,CAAyB8O,WAAzB,OAA2CI,OAAO,CAACJ,WAAR,EAA/C,EAAsE;AAClE,cAAIiB,UAAU,GAAI,KAAKhU,MAAL,CAAYgO,SAAZ,CAAsBC,UAAtB,CAAiC,KAAKjO,MAAL,CAAYiE,YAA7C,EAA2D;AAAEuK,YAAAA,MAAM,EAAE,MAAV;AAAkBN,YAAAA,QAAQ,EAAE,KAAKlO,MAAL,CAAYmO,eAAZ;AAA5B,WAA3D,CAAD,GAA4H,KAA5H,GACZ,KAAKnO,MAAL,CAAYgO,SAAZ,CAAsBC,UAAtB,CAAiCkF,OAAjC,EAA0C;AAAE3E,YAAAA,MAAM,EAAE,OAAV;AAAmBN,YAAAA,QAAQ,EAAE,KAAKlO,MAAL,CAAYmO,eAAZ;AAA7B,WAA1C,CADY,GAEbgF,OAAO,CAACJ,WAAR,EAFJ;AAGA,iBAAOpT,IAAI,CAACoN,mBAAL,CAAyBiH,UAAzB,EAAqC,QAArC,CAAP;AACH;;AACD,YAAIC,IAAI,GAAI,KAAKjU,MAAL,CAAYgO,SAAZ,CAAsBC,UAAtB,CAAiC,KAAKjO,MAAL,CAAYiE,YAA7C,EAA2D;AAAEuK,UAAAA,MAAM,EAAE,MAAV;AAAkBN,UAAAA,QAAQ,EAAE,KAAKlO,MAAL,CAAYmO,eAAZ;AAA5B,SAA3D,CAAD,GAA4H,GAA5H,GACP,KAAKnO,MAAL,CAAYiE,YAAZ,CAAyB8O,WAAzB,EADO,GACkC,KADlC,GAC2C,KAAK/S,MAAL,CAAYgO,SAAZ,CAAsBC,UAAtB,CAAiCkF,OAAjC,EAA0C;AAAE3E,UAAAA,MAAM,EAAE,OAAV;AAAmBN,UAAAA,QAAQ,EAAE,KAAKlO,MAAL,CAAYmO,eAAZ;AAA7B,SAA1C,CAD3C,GAEPgF,OAAO,CAACJ,WAAR,EAFJ;AAGA,eAAOpT,IAAI,CAACoN,mBAAL,CAAyBkH,IAAzB,EAA+B,QAA/B,CAAP;AACH;;AACD,UAAIzF,MAAM,GAAI,KAAKxO,MAAL,CAAY6E,iBAAZ,CAA8BkP,UAA/B,GAA6C,KAAK/T,MAAL,CAAY6E,iBAAZ,CAA8BkP,UAA3E,GAAwF,QAArG;AACA,aAAOpU,IAAI,CAACoN,mBAAL,CAAyB,KAAK/M,MAAL,CAAYgO,SAAZ,CAAsBC,UAAtB,CAAiC,KAAKjO,MAAL,CAAYiE,YAA7C,EAA2D;AAAEuK,QAAAA,MAAM,EAAEA,MAAV;AAAkBN,QAAAA,QAAQ,EAAE,KAAKlO,MAAL,CAAYmO,eAAZ;AAA5B,OAA3D,CAAzB,EAAkJ,QAAlJ,CAAP;AACH;;AACD,WAAO,KAAK+F,eAAL,CAAqB,KAAKlU,MAAL,CAAYiE,YAAjC,CAAP;AACH,GAnBD;;AAoBAnE,EAAAA,KAAK,CAAChB,SAAN,CAAgBqV,YAAhB,GAA+B,UAAUC,IAAV,EAAgB;AAC3C,WAAO,KAAKpU,MAAL,CAAYqU,SAAZ,CAAsBC,WAAtB,CAAkCF,IAAlC,IAA0C,MAA1C,GAAmDzU,IAAI,CAACoN,mBAAL,CAAyB,KAAK/M,MAAL,CAAYgO,SAAZ,CAAsBC,UAAtB,CAAiC,KAAKjO,MAAL,CAAYiE,YAA7C,EAA2D;AAAEuK,MAAAA,MAAM,EAAE,QAAV;AAAoBN,MAAAA,QAAQ,EAAE,KAAKlO,MAAL,CAAYmO,eAAZ;AAA9B,KAA3D,CAAzB,EAAoJ,QAApJ,CAA1D;AACH,GAFD;;AAGArO,EAAAA,KAAK,CAAChB,SAAN,CAAgBoN,uBAAhB,GAA0C,UAAU+H,IAAV,EAAgB;AACtD,QAAIrJ,EAAE,GAAGzL,aAAa,CAAC,IAAD,CAAtB;AACA,QAAIqM,EAAE,GAAGrM,aAAa,CAAC,IAAD,EAAO;AACzBuH,MAAAA,SAAS,EAAE7G,GAAG,CAAC0U,iBADU;AAEzBrD,MAAAA,KAAK,EAAE;AAAE,iBAAU+C,IAAI,GAAG,KAAKjU,MAAL,CAAYqU,SAAZ,CAAsBC,WAAtB,CAAkC,MAAlC,IAA4C,GAA5C,GAAkDL,IAArD,GAA4D;AAA5E,OAFkB;AAGzBnH,MAAAA,SAAS,EAAGmH,IAAI,IAAI;AAHK,KAAP,CAAtB;AAKArJ,IAAAA,EAAE,CAACT,WAAH,CAAeqB,EAAf;AACA,QAAIvK,IAAI,GAAG;AAAEwN,MAAAA,WAAW,EAAE,gBAAf;AAAiCxM,MAAAA,OAAO,EAAEuJ;AAA1C,KAAX;AACA,SAAKxL,MAAL,CAAY0O,OAAZ,CAAoB9O,KAAK,CAAC+O,UAA1B,EAAsC1N,IAAtC;AACA,WAAO2J,EAAP;AACH,GAXD;;AAYA9K,EAAAA,KAAK,CAAChB,SAAN,CAAgB0V,YAAhB,GAA+B,YAAY,CACvC;AACH,GAFD;AAGA;AACJ;AACA;;;AACI1U,EAAAA,KAAK,CAAChB,SAAN,CAAgB0T,aAAhB,GAAgC,YAAY;AACxC,WAAO,OAAP;AACH,GAFD;AAGA;AACJ;AACA;AACA;AACA;;;AACI1S,EAAAA,KAAK,CAAChB,SAAN,CAAgB2V,OAAhB,GAA0B,YAAY;AAClC,QAAI,KAAKzU,MAAL,CAAY0U,WAAhB,EAA6B;AACzB;AACH;;AACD,QAAI,KAAKzS,OAAT,EAAkB;AACd,WAAKuS,YAAL;;AACA,UAAI,KAAKxU,MAAL,CAAYkF,YAAhB,EAA8B;AAC1B,aAAKlF,MAAL,CAAYkF,YAAZ,CAAyBuP,OAAzB;AACH;;AACDrV,MAAAA,MAAM,CAAC,KAAK6C,OAAN,CAAN;AACA,WAAKA,OAAL,GAAe,IAAf;;AACA,UAAI,KAAKjC,MAAL,CAAY2U,mBAAhB,EAAqC;AACjC,aAAK3U,MAAL,CAAY2U,mBAAZ,CAAgCC,WAAhC;AACH;AACJ;AACJ,GAfD;;AAgBA,SAAO9U,KAAP;AACH,CAhnB0B,CAgnBzBL,QAhnByB,CAA3B;;AAinBA,SAASK,KAAT","sourcesContent":["var __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    }\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nimport { EventHandler, formatUnit, isNullOrUndefined } from '@syncfusion/ej2-base';\r\nimport { createElement, remove, addClass, removeClass, append, prepend } from '@syncfusion/ej2-base';\r\nimport { ViewBase } from './view-base';\r\nimport { MonthEvent } from '../event-renderer/month';\r\nimport * as util from '../base/util';\r\nimport * as event from '../base/constant';\r\nimport * as cls from '../base/css-constant';\r\n/**\r\n * month view\r\n */\r\nvar Month = /** @class */ (function (_super) {\r\n    __extends(Month, _super);\r\n    /**\r\n     * Constructor for month view\r\n     */\r\n    function Month(parent) {\r\n        var _this = _super.call(this, parent) || this;\r\n        _this.dayNameFormat = 'wide';\r\n        _this.viewClass = 'e-month-view';\r\n        _this.isInverseTableSelect = false;\r\n        _this.monthDates = {};\r\n        return _this;\r\n    }\r\n    Month.prototype.addEventListener = function () {\r\n        this.parent.on(event.scrollUiUpdate, this.onScrollUIUpdate, this);\r\n        this.parent.on(event.dataReady, this.onDataReady, this);\r\n        this.parent.on(event.cellClick, this.onCellClick, this);\r\n    };\r\n    Month.prototype.removeEventListener = function () {\r\n        this.parent.off(event.scrollUiUpdate, this.onScrollUIUpdate);\r\n        this.parent.off(event.dataReady, this.onDataReady);\r\n        this.parent.off(event.cellClick, this.onCellClick);\r\n    };\r\n    Month.prototype.onDataReady = function (args) {\r\n        var monthEvent = new MonthEvent(this.parent);\r\n        monthEvent.renderAppointments();\r\n        this.parent.notify(event.eventsLoaded, {});\r\n    };\r\n    Month.prototype.onCellClick = function (event) {\r\n        // Here cell click\r\n    };\r\n    Month.prototype.onContentScroll = function (e) {\r\n        this.parent.removeNewEventElement();\r\n        this.parent.notify(event.virtualScroll, e);\r\n        this.scrollTopPanel(e.target);\r\n        this.scrollLeftPanel(e.target);\r\n        this.setPersistence();\r\n    };\r\n    Month.prototype.scrollLeftPanel = function (target) {\r\n        var leftPanel = this.getLeftPanelElement();\r\n        if (leftPanel) {\r\n            leftPanel.scrollTop = target.scrollTop;\r\n        }\r\n    };\r\n    Month.prototype.getLeftPanelElement = function () {\r\n        return this.element.querySelector('.' + cls.WEEK_NUMBER_WRAPPER_CLASS);\r\n    };\r\n    Month.prototype.onScrollUIUpdate = function (args) {\r\n        var headerHeight = this.getHeaderBarHeight();\r\n        var header = this.getDatesHeaderElement();\r\n        var content = this.getContentAreaElement();\r\n        var height = this.parent.element.offsetHeight - headerHeight - header.offsetHeight;\r\n        var leftPanel = this.getLeftPanelElement();\r\n        this.setContentHeight(content, leftPanel, height);\r\n        var scrollBarWidth = util.getScrollBarWidth();\r\n        // tslint:disable:no-any\r\n        header.firstElementChild.style[args.cssProperties.rtlBorder] = '';\r\n        header.style[args.cssProperties.rtlPadding] = '';\r\n        if (content.offsetWidth - content.clientWidth > 0) {\r\n            header.firstElementChild.style[args.cssProperties.border] = scrollBarWidth > 0 ? '1px' : '0px';\r\n            header.style[args.cssProperties.padding] = scrollBarWidth > 0 ? scrollBarWidth - 1 + 'px' : '0px';\r\n        }\r\n        else {\r\n            header.firstElementChild.style[args.cssProperties.border] = '';\r\n            header.style[args.cssProperties.padding] = '';\r\n        }\r\n        // tslint:enable:no-any\r\n        this.setColWidth(content);\r\n        if (args.scrollPosition) {\r\n            if (leftPanel) {\r\n                leftPanel.scrollTop = args.scrollPosition.top;\r\n            }\r\n            content.scrollTop = args.scrollPosition.top;\r\n            content.scrollLeft = args.scrollPosition.left;\r\n        }\r\n        else {\r\n            var headerCell = document.querySelector('.' + cls.HEADER_CELLS_CLASS + '[data-date=\"'\r\n                + this.parent.getMsFromDate(this.parent.selectedDate) + '\"]');\r\n            content.scrollLeft = headerCell !== null ? headerCell.offsetLeft : 0;\r\n        }\r\n        this.retainScrollPosition();\r\n    };\r\n    Month.prototype.setContentHeight = function (content, leftPanelElement, height) {\r\n        content.style.height = 'auto';\r\n        if (this.parent.currentView === 'Month') {\r\n            content.style.height = formatUnit(height);\r\n        }\r\n        if (leftPanelElement) {\r\n            if (this.parent.currentView === 'MonthAgenda') {\r\n                height = this.element.querySelector('.' + cls.CONTENT_TABLE_CLASS).offsetHeight;\r\n            }\r\n            leftPanelElement.style.height = 'auto';\r\n            leftPanelElement.style.height = formatUnit(height - this.getScrollXIndent(content));\r\n        }\r\n    };\r\n    Month.prototype.generateColumnLevels = function () {\r\n        var colLevels = [];\r\n        var level = this.getDateSlots(this.renderDates, this.parent.activeViewOptions.workDays);\r\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\r\n            colLevels = this.parent.resourceBase.generateResourceLevels(level);\r\n            if (this.parent.currentView === 'MonthAgenda') {\r\n                colLevels = [level];\r\n            }\r\n            if (this.parent.uiStateValues.isGroupAdaptive && this.parent.resourceBase.lastResourceLevel.length > 0) {\r\n                var resourceLevel = this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex];\r\n                colLevels = [this.getDateSlots(resourceLevel.renderDates, resourceLevel.workDays)];\r\n            }\r\n        }\r\n        else {\r\n            colLevels.push(level);\r\n        }\r\n        this.colLevels = colLevels;\r\n        return colLevels;\r\n    };\r\n    Month.prototype.getDateSlots = function (renderDates, workDays) {\r\n        var count = this.parent.activeViewOptions.showWeekend ? util.WEEK_LENGTH : workDays.length;\r\n        var dateSlots = [];\r\n        for (var col = 0; col < count; col++) {\r\n            var classList = [cls.HEADER_CELLS_CLASS];\r\n            var currentDateIndex = renderDates.slice(0, count).map(function (date) { return date.getDay(); });\r\n            if (this.isCurrentMonth(this.parent.selectedDate) && currentDateIndex.indexOf(this.parent.getCurrentTime().getDay()) === col) {\r\n                classList.push(cls.CURRENT_DAY_CLASS);\r\n            }\r\n            dateSlots.push({ date: renderDates[col], type: 'monthDay', className: classList, colSpan: 1, workDays: workDays });\r\n        }\r\n        return dateSlots;\r\n    };\r\n    Month.prototype.getDayNameFormat = function () {\r\n        if (this.parent.isAdaptive || this.parent.activeViewOptions.group.resources.length > 0) {\r\n            return 'abbreviated';\r\n        }\r\n        return 'wide';\r\n    };\r\n    Month.prototype.serverRenderLayout = function () {\r\n        var curElem = [].slice.call(this.parent.element.querySelectorAll('.' + cls.CURRENT_DAY_CLASS));\r\n        if (curElem.length > 0) {\r\n            removeClass(curElem, cls.CURRENT_DAY_CLASS);\r\n        }\r\n        var curDate = util.addLocalOffset(new Date(new Date().setHours(0, 0, 0, 0)));\r\n        var queryString = '.' + cls.WORK_CELLS_CLASS + '[data-date=\"' + curDate.getTime().toString() + '\"]';\r\n        if (this.parent.currentView === 'Month' || this.parent.currentView === 'MonthAgenda') {\r\n            curElem = [].slice.call(this.parent.element.querySelectorAll('.' + cls.CURRENTDATE_CLASS));\r\n            if (curElem.length > 0) {\r\n                removeClass(curElem, cls.CURRENTDATE_CLASS);\r\n            }\r\n            var curEle = [].slice.call(this.parent.element.querySelectorAll(queryString));\r\n            for (var _i = 0, curEle_1 = curEle; _i < curEle_1.length; _i++) {\r\n                var ele = curEle_1[_i];\r\n                var index = ele.cellIndex;\r\n                var curHeader = [].slice.call(this.parent.element.querySelectorAll('.' + cls.HEADER_CELLS_CLASS))[index];\r\n                addClass([ele], cls.CURRENTDATE_CLASS);\r\n                addClass([curHeader], cls.CURRENT_DAY_CLASS);\r\n            }\r\n        }\r\n        if (this.parent.currentView === 'TimelineMonth') {\r\n            var curEle = this.parent.element.querySelector('.' + cls.HEADER_CELLS_CLASS + '[data-date=\"' + curDate.getTime().toString() + '\"]');\r\n            if (!isNullOrUndefined(curEle)) {\r\n                addClass([curEle], cls.CURRENT_DAY_CLASS);\r\n            }\r\n        }\r\n        this.setPanel(this.parent.element.querySelector('.' + cls.TABLE_WRAP_CLASS));\r\n        var target = (this.parent.currentView === 'MonthAgenda') ? this.parent.activeView.getPanel() : this.parent.element;\r\n        var headerCells = [].slice.call(this.element.querySelectorAll('.' + cls.DATE_HEADER_WRAP_CLASS + ' td.' + cls.HEADER_CELLS_CLASS));\r\n        for (var _a = 0, headerCells_1 = headerCells; _a < headerCells_1.length; _a++) {\r\n            var cell = headerCells_1[_a];\r\n            EventHandler.clearEvents(cell);\r\n            this.wireCellEvents(cell);\r\n        }\r\n        var contentBody = this.element.querySelector('.' + cls.CONTENT_TABLE_CLASS + ' tbody');\r\n        EventHandler.clearEvents(contentBody);\r\n        this.wireCellEvents(contentBody);\r\n        if (this.parent.virtualScrollModule) {\r\n            this.parent.virtualScrollModule.setTranslateValue();\r\n        }\r\n        var wrap = this.element.querySelector('.' + cls.CONTENT_WRAP_CLASS);\r\n        EventHandler.clearEvents(wrap);\r\n        EventHandler.add(wrap, 'scroll', this.onContentScroll, this);\r\n        this.wireExpandCollapseIconEvents();\r\n        this.renderAppointmentContainer();\r\n        if (this.parent.uiStateValues.isGroupAdaptive && !target.querySelector('.' + cls.RESOURCE_TOOLBAR_CONTAINER)) {\r\n            this.renderResourceMobileLayout();\r\n        }\r\n        this.parent.notify(event.contentReady, {});\r\n    };\r\n    Month.prototype.renderLayout = function (type) {\r\n        this.dayNameFormat = this.getDayNameFormat();\r\n        if (this.parent.isServerRenderer()) {\r\n            this.colLevels = this.generateColumnLevels();\r\n            if (this.parent.activeView.isTimelineView() && this.parent.resourceBase &&\r\n                this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\r\n                this.parent.resourceBase.setRenderedResources();\r\n            }\r\n            return;\r\n        }\r\n        this.setPanel(createElement('div', { className: cls.TABLE_WRAP_CLASS }));\r\n        var clsList = [this.viewClass];\r\n        clsList.push(type);\r\n        if (this.parent.activeViewOptions.group.byDate) {\r\n            clsList.push('e-by-date');\r\n        }\r\n        if (this.parent.activeViewOptions.allowVirtualScrolling) {\r\n            clsList.push(cls.VIRTUAL_SCROLL_CLASS);\r\n        }\r\n        if (this.parent.eventSettings.ignoreWhitespace) {\r\n            clsList.push(cls.IGNORE_WHITESPACE);\r\n        }\r\n        addClass([this.element], clsList);\r\n        this.renderPanel(type);\r\n        this.element.appendChild(this.createTableLayout(cls.OUTER_TABLE_CLASS));\r\n        this.element.querySelector('table').setAttribute('role', 'presentation');\r\n        this.colLevels = this.generateColumnLevels();\r\n        this.renderHeader();\r\n        this.renderContent();\r\n        var target = (this.parent.currentView === 'MonthAgenda') ? this.parent.activeView.getPanel() : this.parent.element;\r\n        if (this.parent.uiStateValues.isGroupAdaptive && !target.querySelector('.' + cls.RESOURCE_TOOLBAR_CONTAINER)) {\r\n            this.renderResourceMobileLayout();\r\n        }\r\n        this.parent.notify(event.contentReady, {});\r\n    };\r\n    Month.prototype.wireCellEvents = function (element) {\r\n        EventHandler.add(element, 'mousedown', this.parent.workCellAction.cellMouseDown, this.parent.workCellAction);\r\n        EventHandler.add(element, 'click', this.parent.workCellAction.cellClick, this.parent.workCellAction);\r\n        if (!this.parent.isAdaptive) {\r\n            EventHandler.add(element, 'dblclick', this.parent.workCellAction.cellDblClick, this.parent.workCellAction);\r\n        }\r\n    };\r\n    Month.prototype.renderHeader = function () {\r\n        var tr = createElement('tr');\r\n        this.renderLeftIndent(tr);\r\n        var dateTd = createElement('td');\r\n        dateTd.appendChild(this.renderDatesHeader());\r\n        tr.appendChild(dateTd);\r\n        prepend([tr], this.element.querySelector('tbody'));\r\n    };\r\n    Month.prototype.renderLeftIndent = function (tr) {\r\n        if (this.parent.activeViewOptions.showWeekNumber) {\r\n            tr.appendChild(createElement('td', { className: 'e-left-indent' }));\r\n        }\r\n    };\r\n    Month.prototype.renderContent = function () {\r\n        var tr = createElement('tr');\r\n        if (this.parent.activeViewOptions.showWeekNumber) {\r\n            tr.appendChild(this.renderWeekNumberContent());\r\n        }\r\n        var workTd = createElement('td');\r\n        var wrap = createElement('div', { className: cls.CONTENT_WRAP_CLASS });\r\n        var contentArea = this.renderContentArea();\r\n        if (this.parent.currentView === 'Month') {\r\n            wrap.appendChild(contentArea);\r\n        }\r\n        else {\r\n            var monthAgendaWrapper = createElement('div', { className: cls.TABLE_CONTAINER_CLASS });\r\n            monthAgendaWrapper.appendChild(contentArea);\r\n            wrap.appendChild(monthAgendaWrapper);\r\n        }\r\n        EventHandler.add(wrap, 'scroll', this.onContentScroll, this);\r\n        workTd.appendChild(wrap);\r\n        tr.appendChild(workTd);\r\n        this.element.querySelector('tbody').appendChild(tr);\r\n        this.renderAppointmentContainer();\r\n    };\r\n    Month.prototype.renderWeekNumberContent = function () {\r\n        var dateCol = this.renderDates.map(function (date) { return new Date(+date); });\r\n        var td = createElement('td');\r\n        var contentWrapper = createElement('div', { className: cls.WEEK_NUMBER_WRAPPER_CLASS });\r\n        td.appendChild(contentWrapper);\r\n        var contentWrapTable = this.createTableLayout();\r\n        contentWrapper.appendChild(contentWrapTable);\r\n        var noOfDays = this.parent.activeViewOptions.showWeekend ? util.WEEK_LENGTH :\r\n            this.parent.activeViewOptions.workDays.length;\r\n        for (var i = 0, length_1 = (this.renderDates.length / noOfDays); i < length_1; i++) {\r\n            var dates = dateCol.splice(0, noOfDays);\r\n            var weekNumber = this.getWeekNumberContent(dates).toString();\r\n            contentWrapTable.querySelector('tbody').appendChild(this.createWeekNumberElement(weekNumber));\r\n        }\r\n        return td;\r\n    };\r\n    Month.prototype.renderAppointmentContainer = function () {\r\n        //Here needs to render mobile view appointment details on selected date\r\n    };\r\n    Month.prototype.renderDatesHeader = function () {\r\n        var container = createElement('div', { className: cls.DATE_HEADER_CONTAINER_CLASS });\r\n        var wrap = createElement('div', { className: cls.DATE_HEADER_WRAP_CLASS });\r\n        container.appendChild(wrap);\r\n        var table = this.createTableLayout();\r\n        this.createColGroup(table, this.colLevels[this.colLevels.length - 1]);\r\n        var trEle = createElement('tr');\r\n        for (var i = 0; i < this.colLevels.length; i++) {\r\n            var level = this.colLevels[i];\r\n            var ntr = trEle.cloneNode();\r\n            for (var j = 0; j < level.length; j++) {\r\n                var td = level[j];\r\n                ntr.appendChild(this.createHeaderCell(td));\r\n            }\r\n            table.querySelector('tbody').appendChild(ntr);\r\n        }\r\n        wrap.appendChild(table);\r\n        return container;\r\n    };\r\n    Month.prototype.createHeaderCell = function (td) {\r\n        var tdEle = createElement('td');\r\n        this.addAttributes(td, tdEle);\r\n        if (td.type === 'monthDay') {\r\n            var ele = createElement('span', { innerHTML: util.capitalizeFirstWord(this.parent.getDayNames(this.dayNameFormat)[td.date.getDay()], 'single') });\r\n            tdEle.appendChild(ele);\r\n        }\r\n        if (td.type === 'resourceHeader') {\r\n            this.setResourceHeaderContent(tdEle, td);\r\n        }\r\n        if (td.type === 'dateHeader') {\r\n            addClass([tdEle], cls.DATE_HEADER_CLASS);\r\n            tdEle.setAttribute('data-date', td.date.getTime().toString());\r\n            if (this.parent.activeViewOptions.dateHeaderTemplate) {\r\n                var dateValue = util.addLocalOffset(td.date);\r\n                var cellArgs = { date: dateValue, type: td.type };\r\n                var elementId = this.parent.element.id + '_';\r\n                var viewName = this.parent.activeViewOptions.dateHeaderTemplateName;\r\n                var templateId = elementId + viewName + 'dateHeaderTemplate';\r\n                var dateTemplate = [].slice.call(this.parent.getDateHeaderTemplate()(cellArgs, this.parent, 'dateHeaderTemplate', templateId, false));\r\n                if (dateTemplate && dateTemplate.length) {\r\n                    append(dateTemplate, tdEle);\r\n                }\r\n            }\r\n            else {\r\n                var ele = createElement('span', { className: cls.NAVIGATE_CLASS });\r\n                var skeleton = 'full';\r\n                var title = this.parent.globalize.formatDate(td.date, { skeleton: skeleton, calendar: this.parent.getCalendarMode() });\r\n                ele.setAttribute('title', util.capitalizeFirstWord(title, 'multiple'));\r\n                var innerText = (this.parent.calendarUtil.isMonthStart(td.date) && !this.isCurrentDate(td.date) && !this.parent.isAdaptive) ?\r\n                    this.parent.globalize.formatDate(td.date, { format: 'MMM d', calendar: this.parent.getCalendarMode() }) :\r\n                    this.parent.globalize.formatDate(td.date, { skeleton: 'd', calendar: this.parent.getCalendarMode() });\r\n                ele.innerHTML = util.capitalizeFirstWord(innerText, 'single');\r\n                tdEle.appendChild(ele);\r\n            }\r\n            this.wireCellEvents(tdEle);\r\n        }\r\n        var args = { elementType: td.type, element: tdEle, date: td.date, groupIndex: td.groupIndex };\r\n        this.parent.trigger(event.renderCell, args);\r\n        return tdEle;\r\n    };\r\n    Month.prototype.getContentSlots = function () {\r\n        if (!(this.colLevels[this.colLevels.length - 1] && this.colLevels[this.colLevels.length - 1][0])) {\r\n            return [];\r\n        }\r\n        var slotDatas = [];\r\n        var prepareSlots = function (rowIndex, renderDate, resData, classList) {\r\n            var data = {\r\n                date: new Date(+renderDate), groupIndex: resData.groupIndex, workDays: resData.workDays,\r\n                type: 'monthCells', className: classList || [cls.WORK_CELLS_CLASS]\r\n            };\r\n            if (!slotDatas[rowIndex]) {\r\n                slotDatas[rowIndex] = [];\r\n            }\r\n            slotDatas[rowIndex].push(data);\r\n        };\r\n        var includeResource = this.parent.currentView !== 'MonthAgenda' &&\r\n            this.parent.activeViewOptions.group.resources.length > 0;\r\n        if (includeResource && !this.parent.uiStateValues.isGroupAdaptive && !this.parent.activeViewOptions.group.byDate) {\r\n            for (var _i = 0, _a = this.colLevels[this.colLevels.length - 2]; _i < _a.length; _i++) {\r\n                var res = _a[_i];\r\n                var dates = res.renderDates.map(function (date) { return new Date(+date); });\r\n                var count = this.parent.activeViewOptions.showWeekend ? util.WEEK_LENGTH : res.workDays.length;\r\n                for (var i = 0; i < (res.renderDates.length / count); i++) {\r\n                    var colDates = dates.splice(0, count);\r\n                    for (var _b = 0, colDates_1 = colDates; _b < colDates_1.length; _b++) {\r\n                        var colDate = colDates_1[_b];\r\n                        prepareSlots(i, colDate, res);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            var dates = this.renderDates.map(function (date) { return new Date(+date); });\r\n            var count = this.parent.activeViewOptions.showWeekend ? util.WEEK_LENGTH :\r\n                this.parent.activeViewOptions.workDays.length;\r\n            for (var i = 0; i < (this.renderDates.length / count); i++) {\r\n                var colDates = dates.splice(0, count);\r\n                for (var _c = 0, colDates_2 = colDates; _c < colDates_2.length; _c++) {\r\n                    var colDate = colDates_2[_c];\r\n                    if (includeResource) {\r\n                        var lastRow = this.colLevels[(this.colLevels.length - 1)];\r\n                        var resourcesTd = lastRow.slice(0, lastRow.length / count);\r\n                        for (var resIndex = 0; resIndex < resourcesTd.length; resIndex++) {\r\n                            var clsList = void 0;\r\n                            if (resIndex !== 0) {\r\n                                clsList = [cls.WORK_CELLS_CLASS, cls.DISABLE_DATE];\r\n                            }\r\n                            prepareSlots(i, colDate, resourcesTd[resIndex], clsList);\r\n                        }\r\n                    }\r\n                    else {\r\n                        prepareSlots(i, colDate, this.colLevels[this.colLevels.length - 1][0]);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return slotDatas;\r\n    };\r\n    Month.prototype.updateClassList = function (data) {\r\n        if (this.isOtherMonth(data.date)) {\r\n            data.className.push(cls.OTHERMONTH_CLASS);\r\n        }\r\n        if (!this.parent.isMinMaxDate(data.date)) {\r\n            data.className.push(cls.DISABLE_DATES);\r\n        }\r\n        if (this.parent.currentView === 'MonthAgenda' && this.parent.isSelectedDate(data.date)) {\r\n            data.className.push(cls.SELECTED_CELL_CLASS);\r\n        }\r\n    };\r\n    Month.prototype.isOtherMonth = function (date) {\r\n        return date.getTime() < this.monthDates.start.getTime() || date.getTime() > this.monthDates.end.getTime();\r\n    };\r\n    Month.prototype.renderContentArea = function () {\r\n        var tbl = this.createTableLayout(cls.CONTENT_TABLE_CLASS);\r\n        this.addAutoHeightClass(tbl);\r\n        if (this.parent.currentView === 'TimelineMonth') {\r\n            this.createColGroup(tbl, this.colLevels[this.colLevels.length - 1]);\r\n        }\r\n        var monthDate = new Date(this.parent.selectedDate.getTime());\r\n        this.monthDates = {\r\n            start: this.parent.calendarUtil.firstDateOfMonth(monthDate),\r\n            end: this.parent.calendarUtil.lastDateOfMonth(util.addMonths(monthDate, this.parent.activeViewOptions.interval - 1))\r\n        };\r\n        var tBody = tbl.querySelector('tbody');\r\n        append(this.getContentRows(), tBody);\r\n        this.wireCellEvents(tBody);\r\n        return tbl;\r\n    };\r\n    Month.prototype.getContentRows = function () {\r\n        var trows = [];\r\n        var tr = createElement('tr', { attrs: { role: 'row' } });\r\n        var td = createElement('td', { attrs: { role: 'gridcell', 'aria-selected': 'false' } });\r\n        var slotDatas = this.getContentSlots();\r\n        for (var row = 0; row < slotDatas.length; row++) {\r\n            var ntr = tr.cloneNode();\r\n            for (var col = 0; col < slotDatas[row].length; col++) {\r\n                var ntd = this.createContentTd(slotDatas[row][col], td);\r\n                ntr.appendChild(ntd);\r\n            }\r\n            trows.push(ntr);\r\n        }\r\n        return trows;\r\n    };\r\n    Month.prototype.createContentTd = function (data, td) {\r\n        var ntd = td.cloneNode();\r\n        if (data.colSpan) {\r\n            ntd.setAttribute('colspan', data.colSpan.toString());\r\n        }\r\n        this.updateClassList(data);\r\n        var type = data.type;\r\n        if (data.className.indexOf(cls.RESOURCE_PARENT_CLASS) !== -1) {\r\n            data.className.push(cls.RESOURCE_GROUP_CELLS_CLASS);\r\n            type = 'resourceGroupCells';\r\n        }\r\n        if (this.parent.workHours.highlight && this.isWorkDay(data.date, data.workDays)) {\r\n            data.className.push(cls.WORKDAY_CLASS);\r\n        }\r\n        if (this.isCurrentDate(data.date)) {\r\n            data.className.push(cls.CURRENTDATE_CLASS);\r\n        }\r\n        addClass([ntd], data.className);\r\n        ntd.setAttribute('data-date', data.date.getTime().toString());\r\n        if (!isNullOrUndefined(data.groupIndex) || this.parent.uiStateValues.isGroupAdaptive) {\r\n            var groupIndex = this.parent.uiStateValues.isGroupAdaptive ? this.parent.uiStateValues.groupIndex :\r\n                data.groupIndex;\r\n            ntd.setAttribute('data-group-index', '' + groupIndex);\r\n        }\r\n        this.renderDateHeaderElement(data, ntd);\r\n        if (this.parent.activeViewOptions.cellTemplate) {\r\n            var dateValue = util.addLocalOffset(data.date);\r\n            var args_1 = { date: dateValue, type: type, groupIndex: data.groupIndex };\r\n            var scheduleId = this.parent.element.id + '_';\r\n            var viewName = this.parent.activeViewOptions.cellTemplateName;\r\n            var templateId = scheduleId + viewName + 'cellTemplate';\r\n            var cellTemplate = [].slice.call(this.parent.getCellTemplate()(args_1, this.parent, 'cellTemplate', templateId, false));\r\n            append(cellTemplate, ntd);\r\n        }\r\n        var args = { elementType: type, element: ntd, date: data.date, groupIndex: data.groupIndex };\r\n        this.parent.trigger(event.renderCell, args);\r\n        return ntd;\r\n    };\r\n    Month.prototype.renderDateHeaderElement = function (data, ntd) {\r\n        if (this.parent.currentView === 'TimelineMonth') {\r\n            return;\r\n        }\r\n        var dateHeader = createElement('div', { className: cls.DATE_HEADER_CLASS });\r\n        if (this.parent.activeViewOptions.cellHeaderTemplate) {\r\n            var dateValue = util.addLocalOffset(data.date);\r\n            var args = { date: dateValue, type: data.type, groupIndex: data.groupIndex };\r\n            var scheduleId = this.parent.element.id + '_';\r\n            var viewName = this.parent.activeViewOptions.cellHeaderTemplateName;\r\n            var templateId = scheduleId + viewName + 'cellHeaderTemplate';\r\n            var cellheaderTemplate = [].slice.call(this.parent.getCellHeaderTemplate()(args, this.parent, 'cellHeaderTemplate', templateId, false));\r\n            append(cellheaderTemplate, dateHeader);\r\n        }\r\n        else {\r\n            var innerText = (this.parent.calendarUtil.isMonthStart(data.date) && !this.isCurrentDate(data.date) && !this.parent.isAdaptive) ?\r\n                this.parent.globalize.formatDate(data.date, { format: 'MMM d', calendar: this.parent.getCalendarMode() }) :\r\n                this.parent.globalize.formatDate(data.date, { skeleton: 'd', calendar: this.parent.getCalendarMode() });\r\n            dateHeader.innerHTML = util.capitalizeFirstWord(innerText, 'single');\r\n        }\r\n        ntd.appendChild(dateHeader);\r\n        if (this.getModuleName() === 'month') {\r\n            addClass([dateHeader], cls.NAVIGATE_CLASS);\r\n            var skeleton = 'full';\r\n            var annocementText = this.parent.globalize.formatDate(data.date, { skeleton: skeleton, calendar: this.parent.getCalendarMode() });\r\n            dateHeader.setAttribute('aria-label', annocementText);\r\n        }\r\n    };\r\n    Month.prototype.getMonthStart = function (currentDate) {\r\n        var monthStart = util.getWeekFirstDate(this.parent.calendarUtil.firstDateOfMonth(currentDate), this.parent.activeViewOptions.firstDayOfWeek);\r\n        var start = new Date(monthStart.getFullYear(), monthStart.getMonth(), monthStart.getDate());\r\n        return start;\r\n    };\r\n    Month.prototype.getMonthEnd = function (currentDate) {\r\n        var endDate = util.addMonths(currentDate, this.parent.activeViewOptions.interval - 1);\r\n        var lastWeekOfMonth = util.getWeekFirstDate(this.parent.calendarUtil.lastDateOfMonth(endDate), this.parent.activeViewOptions.firstDayOfWeek);\r\n        var monthEnd = util.addDays(lastWeekOfMonth, util.WEEK_LENGTH - 1);\r\n        return monthEnd;\r\n    };\r\n    Month.prototype.getRenderDates = function (workDays) {\r\n        var renderDates = [];\r\n        var currentDate = util.resetTime(this.parent.selectedDate);\r\n        var start = this.getMonthStart(currentDate);\r\n        var monthEnd = this.getMonthEnd(currentDate);\r\n        do {\r\n            if (this.parent.activeViewOptions.showWeekend) {\r\n                renderDates.push(start);\r\n            }\r\n            else {\r\n                if (this.isWorkDay(start, workDays)) {\r\n                    renderDates.push(start);\r\n                }\r\n            }\r\n            start = util.addDays(start, 1);\r\n            if (start.getHours() > 0) {\r\n                start = util.resetTime(start);\r\n            }\r\n        } while (start.getTime() <= monthEnd.getTime());\r\n        if (!workDays) {\r\n            this.renderDates = renderDates;\r\n        }\r\n        if (this.parent.headerModule) {\r\n            this.parent.headerModule.previousNextIconHandler();\r\n        }\r\n        return renderDates;\r\n    };\r\n    Month.prototype.getNextPreviousDate = function (type) {\r\n        if (type === 'next') {\r\n            return util.addMonths(this.parent.selectedDate, this.parent.activeViewOptions.interval);\r\n        }\r\n        else {\r\n            return util.addMonths(this.parent.selectedDate, -(this.parent.activeViewOptions.interval));\r\n        }\r\n    };\r\n    Month.prototype.getEndDateFromStartDate = function (start) {\r\n        return util.addDays(new Date(start.getTime()), 1);\r\n    };\r\n    Month.prototype.getDateRangeText = function () {\r\n        if (this.parent.isAdaptive || isNullOrUndefined(this.parent.activeViewOptions.dateFormat)) {\r\n            if (this.parent.activeViewOptions.interval > 1) {\r\n                var endDate = util.addMonths(util.lastDateOfMonth(this.parent.selectedDate), this.parent.activeViewOptions.interval - 1);\r\n                if (this.parent.selectedDate.getFullYear() === endDate.getFullYear()) {\r\n                    var monthNames = (this.parent.globalize.formatDate(this.parent.selectedDate, { format: 'MMMM', calendar: this.parent.getCalendarMode() })) + ' - ' +\r\n                        (this.parent.globalize.formatDate(endDate, { format: 'MMMM ', calendar: this.parent.getCalendarMode() })) +\r\n                        endDate.getFullYear();\r\n                    return util.capitalizeFirstWord(monthNames, 'single');\r\n                }\r\n                var text = (this.parent.globalize.formatDate(this.parent.selectedDate, { format: 'MMMM', calendar: this.parent.getCalendarMode() })) + ' ' +\r\n                    this.parent.selectedDate.getFullYear() + ' - ' + (this.parent.globalize.formatDate(endDate, { format: 'MMMM ', calendar: this.parent.getCalendarMode() })) +\r\n                    endDate.getFullYear();\r\n                return util.capitalizeFirstWord(text, 'single');\r\n            }\r\n            var format = (this.parent.activeViewOptions.dateFormat) ? this.parent.activeViewOptions.dateFormat : 'MMMM y';\r\n            return util.capitalizeFirstWord(this.parent.globalize.formatDate(this.parent.selectedDate, { format: format, calendar: this.parent.getCalendarMode() }), 'single');\r\n        }\r\n        return this.formatDateRange(this.parent.selectedDate);\r\n    };\r\n    Month.prototype.getLabelText = function (view) {\r\n        return this.parent.localeObj.getConstant(view) + ' of ' + util.capitalizeFirstWord(this.parent.globalize.formatDate(this.parent.selectedDate, { format: 'MMMM y', calendar: this.parent.getCalendarMode() }), 'single');\r\n    };\r\n    Month.prototype.createWeekNumberElement = function (text) {\r\n        var tr = createElement('tr');\r\n        var td = createElement('td', {\r\n            className: cls.WEEK_NUMBER_CLASS,\r\n            attrs: { 'title': (text ? this.parent.localeObj.getConstant('week') + ' ' + text : '') },\r\n            innerHTML: (text || '')\r\n        });\r\n        tr.appendChild(td);\r\n        var args = { elementType: 'weekNumberCell', element: td };\r\n        this.parent.trigger(event.renderCell, args);\r\n        return tr;\r\n    };\r\n    Month.prototype.unwireEvents = function () {\r\n        // No scroller events for month view\r\n    };\r\n    /**\r\n     * Get module name.\r\n     */\r\n    Month.prototype.getModuleName = function () {\r\n        return 'month';\r\n    };\r\n    /**\r\n     * To destroy the month.\r\n     * @return {void}\r\n     * @private\r\n     */\r\n    Month.prototype.destroy = function () {\r\n        if (this.parent.isDestroyed) {\r\n            return;\r\n        }\r\n        if (this.element) {\r\n            this.unwireEvents();\r\n            if (this.parent.resourceBase) {\r\n                this.parent.resourceBase.destroy();\r\n            }\r\n            remove(this.element);\r\n            this.element = null;\r\n            if (this.parent.scheduleTouchModule) {\r\n                this.parent.scheduleTouchModule.resetValues();\r\n            }\r\n        }\r\n    };\r\n    return Month;\r\n}(ViewBase));\r\nexport { Month };\r\n"]},"metadata":{},"sourceType":"module"}